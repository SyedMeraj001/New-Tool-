"use strict";(self.webpackChunkmy_react_app=self.webpackChunkmy_react_app||[]).push([[127],{133:(e,t,s)=>{s.d(t,{A:()=>i});class a{static logChange(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"system",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i={id:this.generateAuditId(),timestamp:(new Date).toISOString(),action:e,user:s,data:this.sanitizeData(t),metadata:a,sessionId:this.getSessionId(),ipAddress:this.getClientIP(),userAgent:navigator.userAgent};return this.auditLog.unshift(i),this.auditLog.length>this.maxLogSize&&(this.auditLog=this.auditLog.slice(0,this.maxLogSize)),this.persistAuditLog(),i.id}static generateAuditId(){return`audit_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}static getSessionId(){let e=sessionStorage.getItem("esg_session_id");return e||(e=`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,sessionStorage.setItem("esg_session_id",e)),e}static getClientIP(){return"client_ip_masked"}static sanitizeData(e){if(!e)return null;const t=JSON.parse(JSON.stringify(e));this.removeSensitiveFields(t,["password","token","secret","key"]);const s=JSON.stringify(t);return s.length>5e3?{_truncated:!0,_originalSize:s.length,summary:this.createDataSummary(t)}:t}static removeSensitiveFields(e,t){"object"===typeof e&&null!==e&&Object.keys(e).forEach(s=>{t.some(e=>s.toLowerCase().includes(e))?e[s]="[REDACTED]":"object"===typeof e[s]&&this.removeSensitiveFields(e[s],t)})}static createDataSummary(e){return Array.isArray(e)?{type:"array",length:e.length,sample:e.slice(0,2)}:"object"===typeof e?{type:"object",keys:Object.keys(e),sampleValues:Object.fromEntries(Object.entries(e).slice(0,3))}:e}static persistAuditLog(){try{localStorage.setItem("esg_audit_log",JSON.stringify(this.auditLog))}catch(e){console.warn("Failed to persist audit log:",e)}}static loadAuditLog(){try{const e=localStorage.getItem("esg_audit_log");e&&(this.auditLog=JSON.parse(e))}catch(e){console.warn("Failed to load audit log:",e),this.auditLog=[]}}static getAuditLog(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[...this.auditLog];return e.user&&(t=t.filter(t=>t.user.toLowerCase().includes(e.user.toLowerCase()))),e.action&&(t=t.filter(t=>t.action.toLowerCase().includes(e.action.toLowerCase()))),e.startDate&&(t=t.filter(t=>new Date(t.timestamp)>=new Date(e.startDate))),e.endDate&&(t=t.filter(t=>new Date(t.timestamp)<=new Date(e.endDate))),e.sessionId&&(t=t.filter(t=>t.sessionId===e.sessionId)),t}static trackDataEntry(e,t){return this.logChange("DATA_ENTRY",e,t,{category:"esg_data",recordCount:Array.isArray(e)?e.length:1,categories:this.extractCategories(e)})}static trackDataUpdate(e,t,s){const a=this.detectChanges(e,t);return this.logChange("DATA_UPDATE",{changes:a,newData:t},s,{category:"esg_data",changeCount:a.length,fieldsChanged:a.map(e=>e.field)})}static trackDataDeletion(e,t){return this.logChange("DATA_DELETE",e,t,{category:"esg_data",recordCount:Array.isArray(e)?e.length:1})}static trackApproval(e,t,s){return this.logChange("APPROVAL_ACTION",{data:e,decision:s},t,{category:"workflow",decision:s,recordCount:Array.isArray(e)?e.length:1})}static trackLogin(e){return this.logChange("USER_LOGIN",null,e,{category:"authentication"})}static trackLogout(e){return this.logChange("USER_LOGOUT",null,e,{category:"authentication"})}static trackReportGeneration(e,t,s){return this.logChange("REPORT_GENERATED",s,t,{category:"reporting",reportType:e})}static detectChanges(e,t){const s=[];if(!e||!t)return s;const a=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";Object.keys(t).forEach(r=>{const n=i?`${i}.${r}`:r;e[r]!==t[r]&&("object"===typeof t[r]&&null!==t[r]&&"object"===typeof e[r]&&null!==e[r]?a(e[r],t[r],n):s.push({field:n,oldValue:e[r],newValue:t[r],changeType:void 0===e[r]?"added":"modified"}))}),Object.keys(e).forEach(a=>{if(!(a in t)){const t=i?`${i}.${a}`:a;s.push({field:t,oldValue:e[a],newValue:void 0,changeType:"deleted"})}})};return a(e,t),s}static extractCategories(e){return e?Array.isArray(e)?[...new Set(e.map(e=>e.category).filter(Boolean))]:e.category?[e.category]:Object.keys(e).filter(e=>["environmental","social","governance"].includes(e)):[]}static generateAuditReport(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this.getAuditLog(e);return{generatedAt:(new Date).toISOString(),totalEntries:t.length,dateRange:{start:t.length>0?t[t.length-1].timestamp:null,end:t.length>0?t[0].timestamp:null},summary:this.generateAuditSummary(t),entries:t.map(e=>{var t;return{...e,data:null!==(t=e.data)&&void 0!==t&&t._truncated?"[TRUNCATED]":e.data}})}}static generateAuditSummary(e){const t={actionCounts:{},userCounts:{},categoryCounts:{},dailyActivity:{}};return e.forEach(e=>{var s;t.actionCounts[e.action]=(t.actionCounts[e.action]||0)+1,t.userCounts[e.user]=(t.userCounts[e.user]||0)+1,null!==(s=e.metadata)&&void 0!==s&&s.category&&(t.categoryCounts[e.metadata.category]=(t.categoryCounts[e.metadata.category]||0)+1);const a=e.timestamp.split("T")[0];t.dailyActivity[a]=(t.dailyActivity[a]||0)+1}),t}static exportAuditLog(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"json",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=this.generateAuditReport(t);return"csv"===e?this.convertToCSV(s.entries):JSON.stringify(s,null,2)}static convertToCSV(e){if(0===e.length)return"";return[["Timestamp","Action","User","Session ID","Metadata"],...e.map(e=>[e.timestamp,e.action,e.user,e.sessionId,JSON.stringify(e.metadata||{})])].map(e=>e.map(e=>`"${String(e).replace(/"/g,'""')}"`).join(",")).join("\n")}static clearAuditLog(){this.auditLog=[],localStorage.removeItem("esg_audit_log")}static getAuditStats(){return{totalEntries:this.auditLog.length,oldestEntry:this.auditLog.length>0?this.auditLog[this.auditLog.length-1].timestamp:null,newestEntry:this.auditLog.length>0?this.auditLog[0].timestamp:null,uniqueUsers:[...new Set(this.auditLog.map(e=>e.user))].length,uniqueSessions:[...new Set(this.auditLog.map(e=>e.sessionId))].length}}}a.auditLog=[],a.maxLogSize=1e3,a.loadAuditLog();const i=a},4127:(e,t,s)=>{s.r(t),s.d(t,{default:()=>u});var a=s(5043),i=s(3005),r=s(6110),n=s(5571),o=s(579);const l=e=>{let{data:t,onApprove:s,onReject:l,onClose:d}=e;const{isDark:c}=(0,i.D)(),g=(0,r.Y)(c),[m,u]=(0,a.useState)("maker"),[h,p]=(0,a.useState)([]),[x,y]=(0,a.useState)(""),[b,v]=(0,a.useState)([]),f=[{id:"maker",name:"Data Entry",status:"completed",user:"Data Analyst"},{id:"checker",name:"Review & Validation",status:"pending",user:"ESG Manager"},{id:"approver",name:"Final Approval",status:"waiting",user:"ESG Director"}],j=e=>{const t={step:m,action:e,user:N(),timestamp:(new Date).toISOString(),comments:x};p([...h,t]),"approve"===e?"checker"===m?u("approver"):"approver"===m&&(null===s||void 0===s||s(b,x)):null===l||void 0===l||l(b,x),y("")},N=()=>({maker:"Data Analyst",checker:"ESG Manager",approver:"ESG Director"}[m]||"Unknown User"),w=e=>{if(e===m)return"active";return f.findIndex(t=>t.id===e)<f.findIndex(e=>e.id===m)?"completed":"pending"};return(0,o.jsx)(n.aF,{isOpen:!0,onClose:d,title:"ESG Data Approval Workflow",size:"xl",children:(0,o.jsxs)("div",{className:"space-y-6",children:[(0,o.jsx)("div",{className:"flex items-center justify-between",children:f.map((e,t)=>(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("div",{className:"flex items-center justify-center w-10 h-10 rounded-full "+("completed"===w(e.id)?"bg-green-500 text-white":"active"===w(e.id)?"bg-blue-500 text-white":"bg-gray-300 text-gray-600"),children:"completed"===w(e.id)?"\u2713":t+1}),(0,o.jsxs)("div",{className:"ml-3",children:[(0,o.jsx)("p",{className:`font-medium ${g.text.primary}`,children:e.name}),(0,o.jsx)("p",{className:`text-sm ${g.text.secondary}`,children:e.user})]}),t<f.length-1&&(0,o.jsx)("div",{className:"w-16 h-1 mx-4 "+("completed"===w(e.id)?"bg-green-500":"bg-gray-300")})]},e.id))}),(0,o.jsxs)("div",{className:`p-4 rounded-lg ${g.bg.subtle}`,children:[(0,o.jsx)("h3",{className:`font-semibold mb-3 ${g.text.primary}`,children:"Data Summary"}),(0,o.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:`text-sm ${g.text.secondary}`,children:"Total Entries"}),(0,o.jsx)("p",{className:`text-lg font-bold ${g.text.primary}`,children:(null===t||void 0===t?void 0:t.length)||0})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:`text-sm ${g.text.secondary}`,children:"Categories"}),(0,o.jsx)("p",{className:`text-lg font-bold ${g.text.primary}`,children:t?[...new Set(t.map(e=>e.category))].length:0})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:`text-sm ${g.text.secondary}`,children:"Status"}),(0,o.jsx)("p",{className:"text-lg font-bold text-yellow-600",children:"Pending Approval"})]})]})]}),(0,o.jsx)("div",{className:"max-h-60 overflow-y-auto",children:(0,o.jsxs)("table",{className:`min-w-full text-sm ${g.text.primary}`,children:[(0,o.jsx)("thead",{className:`${g.bg.subtle}`,children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{className:"px-4 py-2 text-left",children:(0,o.jsx)("input",{type:"checkbox",onChange:e=>{e.target.checked?v((null===t||void 0===t?void 0:t.map((e,t)=>t))||[]):v([])}})}),(0,o.jsx)("th",{className:"px-4 py-2 text-left",children:"Category"}),(0,o.jsx)("th",{className:"px-4 py-2 text-left",children:"Metric"}),(0,o.jsx)("th",{className:"px-4 py-2 text-left",children:"Value"}),(0,o.jsx)("th",{className:"px-4 py-2 text-left",children:"Company"})]})}),(0,o.jsx)("tbody",{children:null===t||void 0===t?void 0:t.map((e,t)=>(0,o.jsxs)("tr",{className:`hover:${g.bg.subtle}`,children:[(0,o.jsx)("td",{className:"px-4 py-2",children:(0,o.jsx)("input",{type:"checkbox",checked:b.includes(t),onChange:e=>{e.target.checked?v([...b,t]):v(b.filter(e=>e!==t))}})}),(0,o.jsx)("td",{className:"px-4 py-2 capitalize",children:e.category}),(0,o.jsx)("td",{className:"px-4 py-2",children:e.metric}),(0,o.jsx)("td",{className:"px-4 py-2 font-bold",children:e.value}),(0,o.jsx)("td",{className:"px-4 py-2",children:e.companyName})]},t))})]})}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:`block text-sm font-medium mb-2 ${g.text.primary}`,children:"Comments"}),(0,o.jsx)("textarea",{value:x,onChange:e=>y(e.target.value),className:`w-full p-3 border rounded-lg ${g.bg.input} ${g.border.input}`,rows:3,placeholder:"Add comments for this approval step..."})]}),h.length>0&&(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:`font-semibold mb-3 ${g.text.primary}`,children:"Approval History"}),(0,o.jsx)("div",{className:"space-y-2",children:h.map((e,t)=>(0,o.jsxs)("div",{className:`p-3 rounded-lg ${g.bg.subtle}`,children:[(0,o.jsxs)("div",{className:"flex justify-between items-start",children:[(0,o.jsxs)("div",{children:[(0,o.jsxs)("p",{className:`font-medium ${g.text.primary}`,children:[e.user," - ",e.action]}),(0,o.jsx)("p",{className:`text-sm ${g.text.secondary}`,children:new Date(e.timestamp).toLocaleString()})]}),(0,o.jsx)("span",{className:"px-2 py-1 rounded text-xs "+("approve"===e.action?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.action})]}),e.comments&&(0,o.jsx)("p",{className:`mt-2 text-sm ${g.text.secondary}`,children:e.comments})]},t))})]}),(0,o.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,o.jsx)(n.$n,{variant:"outline",onClick:d,children:"Cancel"}),(0,o.jsx)(n.$n,{variant:"danger",onClick:()=>j("reject"),disabled:0===b.length,children:"Reject Selected"}),(0,o.jsx)(n.$n,{variant:"success",onClick:()=>j("approve"),disabled:0===b.length,children:"approver"===m?"Final Approve":"Approve & Forward"})]})]})})};var d=s(4191),c=s(133);class g{static initialize(){this.loadNotifications(),this.loadReminderSchedules(),this.startReminderEngine()}static subscribe(e,t){this.subscribers.has(e)||this.subscribers.set(e,[]),this.subscribers.get(e).push(t)}static unsubscribe(e,t){if(this.subscribers.has(e)){const s=this.subscribers.get(e),a=s.indexOf(t);a>-1&&s.splice(a,1)}}static createNotification(e,t,s,a){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"medium",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const n={id:this.generateNotificationId(),type:e,title:t,message:s,userId:a,priority:i,data:r,timestamp:(new Date).toISOString(),read:!1,dismissed:!1,actions:this.getNotificationActions(e)};return this.notifications.unshift(n),this.persistNotifications(),this.notifySubscribers(a,n),n.id}static generateNotificationId(){return`notif_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}static getNotificationActions(e){return{data_validation_failed:[{id:"review",label:"Review Data",action:"navigate",target:"/data-entry"},{id:"dismiss",label:"Dismiss",action:"dismiss"}],approval_pending:[{id:"approve",label:"Review & Approve",action:"navigate",target:"/workflow"},{id:"remind_later",label:"Remind Later",action:"snooze",duration:36e5}],deadline_approaching:[{id:"complete",label:"Complete Now",action:"navigate",target:"/data-entry"},{id:"extend",label:"Request Extension",action:"custom",handler:"requestExtension"}],report_ready:[{id:"view",label:"View Report",action:"navigate",target:"/reports"},{id:"download",label:"Download",action:"custom",handler:"downloadReport"}]}[e]||[{id:"dismiss",label:"Dismiss",action:"dismiss"}]}static notifySubscribers(e,t){[...this.subscribers.get(e)||[],...this.subscribers.get("*")||[]].forEach(e=>{try{e(t)}catch(s){console.error("Notification callback error:",s)}})}static markAsRead(e,t){const s=this.notifications.find(s=>s.id===e&&s.userId===t);return!!s&&(s.read=!0,s.readAt=(new Date).toISOString(),this.persistNotifications(),!0)}static markAsDismissed(e,t){const s=this.notifications.find(s=>s.id===e&&s.userId===t);return!!s&&(s.dismissed=!0,s.dismissedAt=(new Date).toISOString(),this.persistNotifications(),!0)}static getNotifications(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=this.notifications.filter(t=>t.userId===e||"*"===t.userId);return t.unreadOnly&&(s=s.filter(e=>!e.read)),t.type&&(s=s.filter(e=>e.type===t.type)),t.priority&&(s=s.filter(e=>e.priority===t.priority)),t.includeDismissed||(s=s.filter(e=>!e.dismissed)),s.slice(0,t.limit||50)}static getUnreadCount(e){return this.notifications.filter(t=>(t.userId===e||"*"===t.userId)&&!t.read&&!t.dismissed).length}static notifyDataValidationFailed(e,t){var s,a;const i=(null===(s=t.errors)||void 0===s?void 0:s.length)||0,r=(null===(a=t.warnings)||void 0===a?void 0:a.length)||0;return this.createNotification("data_validation_failed","Data Validation Issues",`Found ${i} errors and ${r} warnings in your ESG data submission.`,e,i>0?"high":"medium",{validationResults:t})}static notifyApprovalPending(e,t){const s=Array.isArray(t)?t.length:1;return this.createNotification("approval_pending","Approval Required",`${s} ESG data ${1===s?"entry":"entries"} pending your approval.`,e,"high",{pendingItems:t,count:s})}static notifyDeadlineApproaching(e,t,s){const a=Math.ceil((new Date(t)-new Date)/864e5);return this.createNotification("deadline_approaching","Deadline Approaching",`${s} deadline is in ${a} days (${new Date(t).toLocaleDateString()}).`,e,a<=3?"high":"medium",{deadline:t,taskType:s,daysLeft:a})}static notifyReportReady(e,t,s){return this.createNotification("report_ready","Report Generated",`Your ${t} report has been generated and is ready for review.`,e,"medium",{reportType:t,reportId:s})}static notifyDataSubmitted(e,t){var s;const a=(null===(s=t.categories)||void 0===s?void 0:s.length)||0;return this.createNotification("data_submitted","Data Submitted Successfully",`ESG data for ${a} categories has been submitted for review.`,e,"low",{submissionData:t})}static scheduleReminder(e,t,s){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i={id:this.generateNotificationId(),userId:e,type:t,scheduledFor:new Date(s).toISOString(),data:a,active:!0,created:(new Date).toISOString()};return this.reminderSchedules.push(i),this.persistReminderSchedules(),i.id}static cancelReminder(e){const t=this.reminderSchedules.find(t=>t.id===e);return!!t&&(t.active=!1,this.persistReminderSchedules(),!0)}static startReminderEngine(){setInterval(()=>{this.processReminders()},6e4)}static processReminders(){const e=new Date;this.reminderSchedules.filter(t=>t.active&&new Date(t.scheduledFor)<=e).forEach(e=>{this.triggerReminder(e),e.active=!1}),this.persistReminderSchedules()}static triggerReminder(e){const t={data_entry_due:()=>this.notifyDeadlineApproaching(e.userId,e.data.deadline,"ESG Data Entry"),approval_reminder:()=>this.notifyApprovalPending(e.userId,e.data.pendingItems),report_generation:()=>this.createNotification("report_reminder","Report Generation Reminder",`Time to generate your ${e.data.reportType} report.`,e.userId,"medium",e.data)}[e.type];t&&t()}static markAllAsRead(e){let t=0;return this.notifications.filter(t=>(t.userId===e||"*"===t.userId)&&!t.read).forEach(e=>{e.read=!0,e.readAt=(new Date).toISOString(),t++}),this.persistNotifications(),t}static clearDismissed(e){const t=this.notifications.length;return this.notifications=this.notifications.filter(t=>!t.dismissed||t.userId!==e&&"*"!==t.userId),this.persistNotifications(),t-this.notifications.length}static persistNotifications(){try{localStorage.setItem("esg_notifications",JSON.stringify(this.notifications))}catch(e){console.error("Failed to persist notifications:",e)}}static loadNotifications(){try{const e=localStorage.getItem("esg_notifications");e&&(this.notifications=JSON.parse(e))}catch(e){console.error("Failed to load notifications:",e),this.notifications=[]}}static persistReminderSchedules(){try{localStorage.setItem("esg_reminders",JSON.stringify(this.reminderSchedules))}catch(e){console.error("Failed to persist reminders:",e)}}static loadReminderSchedules(){try{const e=localStorage.getItem("esg_reminders");e&&(this.reminderSchedules=JSON.parse(e))}catch(e){console.error("Failed to load reminders:",e),this.reminderSchedules=[]}}static getNotificationStats(e){const t=this.getNotifications(e,{includeDismissed:!0});return{total:t.length,unread:t.filter(e=>!e.read).length,dismissed:t.filter(e=>e.dismissed).length,byType:this.groupBy(t,"type"),byPriority:this.groupBy(t,"priority"),recentActivity:t.filter(e=>new Date(e.timestamp)>new Date(Date.now()-6048e5)).length}}static groupBy(e,t){return e.reduce((e,s)=>{const a=s[t]||"unknown";return e[a]=(e[a]||0)+1,e},{})}static clearAllNotifications(e){this.notifications=this.notifications.filter(t=>t.userId!==e&&"*"!==t.userId),this.persistNotifications()}}g.notifications=[],g.subscribers=new Map,g.reminderSchedules=[],g.initialize();const m=g,u=()=>{const{isDark:e}=(0,i.D)(),t=(0,r.Y)(e),[s,g]=(0,a.useState)(!1),[u,h]=(0,a.useState)([]),[p,x]=(0,a.useState)([]),[y,b]=(0,a.useState)([]),[v,f]=(0,a.useState)(null),[j,N]=(0,a.useState)(null),[w]=(0,a.useState)("esg_manager");(0,a.useEffect)(()=>{S(),$()},[]);const S=()=>{const e=JSON.parse(localStorage.getItem("esgData")||"[]").filter(e=>"Pending"===e.status||!e.status);h(e);const t=m.getNotifications(w);x(t);const s=c.A.getAuditLog({user:w,startDate:new Date(Date.now()-6048e5).toISOString()});if(b(s.slice(0,10)),e.length>0){const t=d.A.validateESGData(e[0]);f(t)}},$=()=>{m.subscribe(w,e=>{x(t=>[e,...t.slice(0,9)]),A(e.title,"info")})},D=()=>{const e=JSON.parse(localStorage.getItem("esgData")||"[]");if(0===e.length)return void A("No data available for validation","warning");const t=d.A.generateValidationReport(e[0]);f(t),c.A.logChange("VALIDATION_RUN",t,w),"failed"===t.status&&m.notifyDataValidationFailed(w,t.details),A(`Validation completed with ${t.summary.totalErrors} errors`,"passed"===t.status?"success":"error")},A=function(e){N({message:e,type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info"}),setTimeout(()=>N(null),3e3)},C=e=>{switch(e){case"passed":return"text-green-600";case"failed":return"text-red-600";default:return"text-yellow-600"}},k=e=>{switch(e){case"high":return"bg-red-100 text-red-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return(0,o.jsx)("div",{className:`min-h-screen p-6 ${t.bg.gradient}`,children:(0,o.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,o.jsxs)("div",{className:"mb-8",children:[(0,o.jsx)("h1",{className:`text-3xl font-bold ${t.text.primary}`,children:"Workflow & Approval Dashboard"}),(0,o.jsx)("p",{className:`text-lg ${t.text.secondary}`,children:"Manage ESG data approvals, validation, and audit trail"})]}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,o.jsx)("div",{className:`p-6 rounded-xl shadow-lg ${t.bg.card}`,children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:`text-sm ${t.text.secondary}`,children:"Pending Approvals"}),(0,o.jsx)("p",{className:`text-2xl font-bold ${t.text.primary}`,children:u.length})]}),(0,o.jsx)("div",{className:"text-3xl",children:"\u23f3"})]})}),(0,o.jsx)("div",{className:`p-6 rounded-xl shadow-lg ${t.bg.card}`,children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:`text-sm ${t.text.secondary}`,children:"Unread Notifications"}),(0,o.jsx)("p",{className:`text-2xl font-bold ${t.text.primary}`,children:p.filter(e=>!e.read).length})]}),(0,o.jsx)("div",{className:"text-3xl",children:"\ud83d\udd14"})]})}),(0,o.jsx)("div",{className:`p-6 rounded-xl shadow-lg ${t.bg.card}`,children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:`text-sm ${t.text.secondary}`,children:"Validation Status"}),(0,o.jsx)("p",{className:`text-lg font-bold ${v?C(v.status):t.text.primary}`,children:v?v.status.toUpperCase():"NOT RUN"})]}),(0,o.jsx)("div",{className:"text-3xl",children:"\u2705"})]})}),(0,o.jsx)("div",{className:`p-6 rounded-xl shadow-lg ${t.bg.card}`,children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:`text-sm ${t.text.secondary}`,children:"Audit Entries"}),(0,o.jsx)("p",{className:`text-2xl font-bold ${t.text.primary}`,children:y.length})]}),(0,o.jsx)("div",{className:"text-3xl",children:"\ud83d\udccb"})]})})]}),(0,o.jsxs)("div",{className:"flex flex-wrap gap-4 mb-8",children:[(0,o.jsxs)(n.$n,{variant:"primary",onClick:()=>g(!0),disabled:0===u.length,children:["Review Approvals (",u.length,")"]}),(0,o.jsx)(n.$n,{variant:"outline",onClick:D,children:"Run Data Validation"}),(0,o.jsx)(n.$n,{variant:"outline",onClick:S,children:"Refresh Dashboard"})]}),(0,o.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,o.jsxs)("div",{className:`p-6 rounded-xl shadow-lg ${t.bg.card}`,children:[(0,o.jsx)("h2",{className:`text-xl font-bold mb-4 ${t.text.primary}`,children:"Recent Notifications"}),(0,o.jsx)("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:p.length>0?p.map(e=>(0,o.jsx)("div",{className:`p-4 rounded-lg border-l-4 ${e.read?t.bg.subtle:"bg-blue-50 border-blue-500"}`,children:(0,o.jsxs)("div",{className:"flex justify-between items-start",children:[(0,o.jsxs)("div",{className:"flex-1",children:[(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[(0,o.jsx)("h3",{className:`font-semibold ${t.text.primary}`,children:e.title}),(0,o.jsx)("span",{className:`px-2 py-1 rounded text-xs ${k(e.priority)}`,children:e.priority})]}),(0,o.jsx)("p",{className:`text-sm mt-1 ${t.text.secondary}`,children:e.message}),(0,o.jsx)("p",{className:`text-xs mt-2 ${t.text.muted}`,children:new Date(e.timestamp).toLocaleString()})]}),(0,o.jsxs)("div",{className:"flex gap-2 ml-4",children:[!e.read&&(0,o.jsx)("button",{onClick:()=>{return t=e.id,m.markAsRead(t,w),void x(e=>e.map(e=>e.id===t?{...e,read:!0}:e));var t},className:"text-blue-600 hover:text-blue-800 text-sm",children:"Mark Read"}),(0,o.jsx)("button",{onClick:()=>{return t=e.id,m.markAsDismissed(t,w),void x(e=>e.filter(e=>e.id!==t));var t},className:"text-gray-600 hover:text-gray-800 text-sm",children:"Dismiss"})]})]})},e.id)):(0,o.jsx)("p",{className:`text-center py-8 ${t.text.secondary}`,children:"No notifications available"})})]}),(0,o.jsxs)("div",{className:`p-6 rounded-xl shadow-lg ${t.bg.card}`,children:[(0,o.jsx)("h2",{className:`text-xl font-bold mb-4 ${t.text.primary}`,children:"Data Validation Results"}),v?(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:`text-sm ${t.text.secondary}`,children:"Validation Score"}),(0,o.jsxs)("p",{className:`text-2xl font-bold ${C(v.status)}`,children:[v.validationScore,"%"]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:`text-sm ${t.text.secondary}`,children:"Completeness"}),(0,o.jsxs)("p",{className:`text-2xl font-bold ${t.text.primary}`,children:[v.completenessScore,"%"]})]})]}),(0,o.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-center",children:[(0,o.jsxs)("div",{className:`p-3 rounded-lg ${t.bg.subtle}`,children:[(0,o.jsx)("p",{className:"text-red-600 font-bold text-lg",children:v.summary.totalErrors}),(0,o.jsx)("p",{className:`text-sm ${t.text.secondary}`,children:"Errors"})]}),(0,o.jsxs)("div",{className:`p-3 rounded-lg ${t.bg.subtle}`,children:[(0,o.jsx)("p",{className:"text-yellow-600 font-bold text-lg",children:v.summary.totalWarnings}),(0,o.jsx)("p",{className:`text-sm ${t.text.secondary}`,children:"Warnings"})]}),(0,o.jsxs)("div",{className:`p-3 rounded-lg ${t.bg.subtle}`,children:[(0,o.jsx)("p",{className:"text-blue-600 font-bold text-lg",children:v.summary.totalSuggestions}),(0,o.jsx)("p",{className:`text-sm ${t.text.secondary}`,children:"Suggestions"})]})]}),v.details.errors.length>0&&(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"font-semibold mb-2 text-red-600",children:"Critical Errors"}),(0,o.jsx)("ul",{className:"space-y-1",children:v.details.errors.slice(0,3).map((e,s)=>(0,o.jsxs)("li",{className:`text-sm ${t.text.secondary}`,children:["\u2022 ",e]},s))})]})]}):(0,o.jsxs)("div",{className:"text-center py-8",children:[(0,o.jsx)("p",{className:`${t.text.secondary} mb-4`,children:"No validation results available"}),(0,o.jsx)(n.$n,{variant:"outline",onClick:D,children:"Run Validation"})]})]})]}),(0,o.jsxs)("div",{className:`mt-8 p-6 rounded-xl shadow-lg ${t.bg.card}`,children:[(0,o.jsx)("h2",{className:`text-xl font-bold mb-4 ${t.text.primary}`,children:"Recent Audit Trail"}),(0,o.jsx)("div",{className:"overflow-x-auto",children:(0,o.jsxs)("table",{className:`min-w-full text-sm ${t.text.primary}`,children:[(0,o.jsx)("thead",{className:`${t.bg.subtle}`,children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{className:"px-4 py-3 text-left",children:"Timestamp"}),(0,o.jsx)("th",{className:"px-4 py-3 text-left",children:"Action"}),(0,o.jsx)("th",{className:"px-4 py-3 text-left",children:"User"}),(0,o.jsx)("th",{className:"px-4 py-3 text-left",children:"Category"}),(0,o.jsx)("th",{className:"px-4 py-3 text-left",children:"Details"})]})}),(0,o.jsx)("tbody",{className:"divide-y divide-gray-200",children:y.map(e=>{var s,a,i,r,n;return(0,o.jsxs)("tr",{className:`hover:${t.bg.subtle}`,children:[(0,o.jsx)("td",{className:"px-4 py-3",children:new Date(e.timestamp).toLocaleString()}),(0,o.jsx)("td",{className:"px-4 py-3 font-medium",children:e.action}),(0,o.jsx)("td",{className:"px-4 py-3",children:e.user}),(0,o.jsx)("td",{className:"px-4 py-3",children:(0,o.jsx)("span",{className:"px-2 py-1 rounded text-xs "+("esg_data"===(null===(s=e.metadata)||void 0===s?void 0:s.category)?"bg-green-100 text-green-800":"workflow"===(null===(a=e.metadata)||void 0===a?void 0:a.category)?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:(null===(i=e.metadata)||void 0===i?void 0:i.category)||"system"})}),(0,o.jsxs)("td",{className:"px-4 py-3 text-sm",children:[(null===(r=e.metadata)||void 0===r?void 0:r.recordCount)&&`${e.metadata.recordCount} records`,(null===(n=e.metadata)||void 0===n?void 0:n.decision)&&` - ${e.metadata.decision}`]})]},e.id)})})]})})]}),s&&(0,o.jsx)(l,{data:u,onApprove:(e,t)=>{const s=e.map(e=>u[e]);s.forEach(e=>{e.status="Approved",e.approvedBy=w,e.approvedAt=(new Date).toISOString(),e.approvalComments=t});const a=JSON.parse(localStorage.getItem("esgData")||"[]").map(e=>s.find(t=>t.id===e.id)||e);localStorage.setItem("esgData",JSON.stringify(a)),c.A.trackApproval(s,w,"approve"),m.createNotification("approval_completed","Items Approved",`${s.length} ESG data entries have been approved.`,w,"low"),h(t=>t.filter((t,s)=>!e.includes(s))),g(!1),A("Items approved successfully","success")},onReject:(e,t)=>{const s=e.map(e=>u[e]);s.forEach(e=>{e.status="Rejected",e.rejectedBy=w,e.rejectedAt=(new Date).toISOString(),e.rejectionComments=t}),c.A.trackApproval(s,w,"reject"),m.createNotification("approval_rejected","Items Rejected",`${s.length} ESG data entries have been rejected and require revision.`,w,"medium"),h(t=>t.filter((t,s)=>!e.includes(s))),g(!1),A("Items rejected","warning")},onClose:()=>g(!1)}),j&&(0,o.jsx)(n.y8,{message:j.message,type:j.type,onClose:()=>N(null)})]})})}},4191:(e,t,s)=>{s.d(t,{A:()=>i});class a{static validateESGData(e){const t={isValid:!0,errors:[],warnings:[],suggestions:[],score:100};return e&&"object"===typeof e?(["environmental","social","governance"].forEach(s=>{if(e[s]){const a=this.validateCategory(s,e[s]);t.errors.push(...a.errors),t.warnings.push(...a.warnings),t.suggestions.push(...a.suggestions),a.errors.length>0&&(t.isValid=!1)}}),t.score=this.calculateValidationScore(t),this.performCrossValidation(e,t),t):(t.isValid=!1,t.errors.push("Invalid data format provided"),t.score=0,t)}static validateCategory(e,t){const s={errors:[],warnings:[],suggestions:[]},a=this.validationRules[e]||{};return Object.entries(t).forEach(t=>{let[i,r]=t;if("description"===i)return;const n=a[i];if(!n)return void s.warnings.push(`Unknown metric '${i}' in ${e} category`);if(n.required&&(null===r||void 0===r||""===r))return void s.errors.push(`${i} is required in ${e} category`);if(!n.required&&(null===r||void 0===r||""===r))return;const o=parseFloat(r);isNaN(o)?s.errors.push(`${i} must be a valid number`):(o<n.min&&s.errors.push(`${i} cannot be less than ${n.min} ${n.unit}`),o>n.max&&s.errors.push(`${i} cannot exceed ${n.max} ${n.unit}`),this.performBusinessLogicValidation(e,i,o,s))}),s}static performBusinessLogicValidation(e,t,s,a){"environmental"===e&&("renewableEnergyRatio"===t&&s>95&&a.warnings.push("Renewable energy ratio above 95% is exceptional - please verify"),"carbonEmissions"===t&&0===s&&a.warnings.push("Zero carbon emissions reported - please confirm accuracy")),"social"===e&&("femaleEmployeesPercentage"===t&&(s<10||s>90)&&a.warnings.push("Gender distribution appears imbalanced - consider diversity initiatives"),"employeeTurnover"===t&&s>30&&a.warnings.push("High employee turnover detected - may indicate retention issues")),"governance"===e&&("independentDirectors"===t&&s<30&&a.warnings.push("Low board independence - consider increasing independent directors"),"dataBreaches"===t&&s>0&&a.warnings.push("Data breaches reported - ensure proper cybersecurity measures"))}static performCrossValidation(e,t){const s=e.environmental||{},a=e.social||{},i=e.governance||{};if(s.energyConsumption&&s.carbonEmissions){s.carbonEmissions/s.energyConsumption>1&&t.warnings.push("Carbon emissions seem high relative to energy consumption")}if(a.totalEmployees&&i.boardSize&&a.totalEmployees<50&&i.boardSize>10&&t.warnings.push("Board size appears large for company size"),a.communityInvestment&&e.totalRevenue){a.communityInvestment/e.totalRevenue*100>10&&t.warnings.push("Community investment ratio is exceptionally high")}}static calculateValidationScore(e){let t=100;return t-=20*e.errors.length,t-=5*e.warnings.length,Math.max(0,t)}static validateDataCompleteness(e){const t={environmental:0,social:0,governance:0,overall:0};return["environmental","social","governance"].forEach(s=>{const a=e[s]||{},i=this.validationRules[s]||{},r=Object.keys(i).length,n=Object.keys(a).filter(e=>"description"!==e&&null!==a[e]&&void 0!==a[e]&&""!==a[e]).length;t[s]=r>0?Math.round(n/r*100):0}),t.overall=Math.round((t.environmental+t.social+t.governance)/3),t}static generateValidationReport(e){const t=this.validateESGData(e),s=this.validateDataCompleteness(e);return{timestamp:(new Date).toISOString(),validationScore:t.score,completenessScore:s.overall,status:t.isValid?"passed":"failed",summary:{totalErrors:t.errors.length,totalWarnings:t.warnings.length,totalSuggestions:t.suggestions.length},details:{errors:t.errors,warnings:t.warnings,suggestions:t.suggestions,completeness:s},recommendations:this.generateRecommendations(t,s)}}static generateRecommendations(e,t){const s=[];return t.overall<70&&s.push({type:"completeness",priority:"high",message:"Data completeness is below 70%. Consider filling missing fields for better ESG reporting."}),e.errors.length>0&&s.push({type:"validation",priority:"critical",message:"Critical validation errors found. Please address all errors before submission."}),e.warnings.length>3&&s.push({type:"quality",priority:"medium",message:"Multiple data quality warnings detected. Review and verify data accuracy."}),s}static getValidationRulesForCategory(e){return this.validationRules[e]||{}}static isValidMetric(e,t){return!(!this.validationRules[e]||!this.validationRules[e][t])}}a.validationRules={environmental:{energyConsumption:{min:0,max:1e6,unit:"kWh",required:!0},carbonEmissions:{min:0,max:1e5,unit:"T CO2e",required:!0},waterUsage:{min:0,max:1e6,unit:"m\xb3",required:!1},wasteGenerated:{min:0,max:1e4,unit:"tons",required:!1},renewableEnergyRatio:{min:0,max:100,unit:"%",required:!1}},social:{totalEmployees:{min:1,max:1e6,unit:"count",required:!0},femaleEmployeesPercentage:{min:0,max:100,unit:"%",required:!1},trainingHours:{min:0,max:1e3,unit:"hours",required:!1},communityInvestment:{min:0,max:1e7,unit:"USD",required:!1},employeeTurnover:{min:0,max:100,unit:"%",required:!1}},governance:{boardSize:{min:3,max:20,unit:"count",required:!0},independentDirectors:{min:0,max:100,unit:"%",required:!0},ethicsTraining:{min:0,max:100,unit:"%",required:!1},dataBreaches:{min:0,max:1e3,unit:"count",required:!1},regulatoryFines:{min:0,max:1e8,unit:"USD",required:!1}}};const i=a},5571:(e,t,s)=>{s.d(t,{$n:()=>l,Fc:()=>c,aF:()=>o,kt:()=>r,pd:()=>d,y8:()=>n});var a=s(5043),i=s(579);const r=e=>{let{size:t="md",color:s="blue",isDark:a=!1}=e;return(0,i.jsx)("div",{className:`${{sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8"}[t]} border-2 ${{blue:"border-blue-500",green:"border-green-500",red:"border-red-500",white:"border-white"}[s]} border-t-transparent rounded-full animate-spin`})},n=e=>{let{message:t,type:s="success",onClose:r}=e;(0,a.useEffect)(()=>{const e=setTimeout(r,3e3);return()=>clearTimeout(e)},[r]);return(0,i.jsx)("div",{className:`fixed top-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 animate-slide-up ${{success:"bg-green-500 text-white",error:"bg-red-500 text-white",warning:"bg-yellow-500 text-black",info:"bg-blue-500 text-white"}[s]}`,children:(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("span",{children:t}),(0,i.jsx)("button",{onClick:r,className:"ml-2 text-lg",children:"\xd7"})]})})},o=e=>{let{isOpen:t,onClose:s,title:a,children:r,isDark:n=!1}=e;return t?(0,i.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,i.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:s}),(0,i.jsxs)("div",{className:"relative rounded-2xl p-6 max-w-md w-full mx-4 animate-fade-in "+(n?"bg-gray-800 text-white":"bg-white text-gray-900"),children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold",children:a}),(0,i.jsx)("button",{onClick:s,className:"text-2xl "+(n?"text-gray-400 hover:text-gray-200":"text-gray-400 hover:text-gray-600"),children:"\xd7"})]}),r]})]}):null},l=e=>{let{children:t,variant:s="primary",size:a="md",loading:n=!1,disabled:o=!1,onClick:l,icon:d,type:c="button",...g}=e;return(0,i.jsxs)("button",{type:c,className:`\n        inline-flex items-center justify-center font-medium rounded-lg\n        transition-all duration-200 hover:scale-105 active:scale-95\n        ${{primary:"bg-blue-600 hover:bg-blue-700 text-white",secondary:"bg-gray-200 hover:bg-gray-300 text-gray-900",success:"bg-green-600 hover:bg-green-700 text-white",danger:"bg-red-600 hover:bg-red-700 text-white",outline:"border border-gray-300 bg-white hover:bg-gray-50 text-gray-700"}[s]} ${{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"}[a]}\n        ${o||n?"opacity-50 cursor-not-allowed":""}\n      `,disabled:o||n,onClick:l,...g,children:[n&&(0,i.jsx)(r,{size:"sm"}),d&&(0,i.jsx)("span",{className:"mr-2",children:d}),(0,i.jsx)("span",{className:n?"ml-2":"",children:t})]})},d=e=>{let{label:t,error:s,icon:a,className:r="",isDark:n=!1,...o}=e;return(0,i.jsxs)("div",{className:"w-full",children:[t&&(0,i.jsx)("label",{className:"block text-sm font-medium mb-1 "+(n?"text-gray-300":"text-gray-700"),children:t}),(0,i.jsxs)("div",{className:"relative",children:[a&&(0,i.jsx)("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 "+(n?"text-gray-500":"text-gray-400"),children:a}),(0,i.jsx)("input",{className:`\n          w-full px-3 py-2 border rounded-lg transition-all duration-200\n          focus:ring-2 focus:ring-blue-500 focus:border-blue-500\n          ${n?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}\n          ${a?"pl-10":""}\n          ${s?"border-red-500 focus:ring-red-500":""}\n          ${r}\n        `,...o})]}),s&&(0,i.jsx)("p",{className:"mt-1 text-sm text-red-600",children:s})]})},c=e=>{let{type:t="info",title:s,message:a,children:r,onClose:n,isDark:o=!1,className:l=""}=e;const d={info:o?"bg-blue-900/30 border-blue-700 text-blue-300":"bg-blue-50 border-blue-200 text-blue-800",success:o?"bg-green-900/30 border-green-700 text-green-300":"bg-green-50 border-green-200 text-green-800",warning:o?"bg-yellow-900/30 border-yellow-700 text-yellow-300":"bg-yellow-50 border-yellow-200 text-yellow-800",error:o?"bg-red-900/30 border-red-700 text-red-300":"bg-red-50 border-red-200 text-red-800"};return(0,i.jsx)("div",{className:`border rounded-lg p-4 transition-colors duration-300 ${d[t]}`,children:(0,i.jsxs)("div",{className:"flex items-start",children:[(0,i.jsx)("span",{className:"text-lg mr-3",children:{info:"\u2139\ufe0f",success:"\u2705",warning:"\u26a0\ufe0f",error:"\u274c"}[t]}),(0,i.jsxs)("div",{className:"flex-1",children:[s&&(0,i.jsx)("h4",{className:"font-medium mb-1",children:s}),(0,i.jsx)("div",{children:a||r})]}),n&&(0,i.jsx)("button",{onClick:n,className:"ml-3 text-lg hover:opacity-70",children:"\xd7"})]})})}},6110:(e,t,s)=>{s.d(t,{Y:()=>a});const a=e=>({bg:{primary:e?"bg-gray-900":"bg-white",secondary:e?"bg-gray-800":"bg-gray-50",tertiary:e?"bg-gray-700":"bg-gray-100",gradient:e?"bg-gradient-to-br from-gray-900 to-gray-800":"bg-gradient-to-br from-gray-50 via-blue-50 to-indigo-100",card:e?"bg-gray-800":"bg-white",input:e?"bg-gray-700":"bg-white",subtle:e?"bg-gray-700":"bg-gray-50",accent:e?"bg-blue-900/30":"bg-blue-50"},text:{primary:e?"text-white":"text-gray-900",secondary:e?"text-gray-300":"text-gray-700",tertiary:e?"text-gray-400":"text-gray-600",muted:"text-gray-500",accent:"text-blue-500"},border:{primary:e?"border-gray-700":"border-gray-200",secondary:e?"border-gray-600":"border-gray-300",input:e?"border-gray-600":"border-gray-300"},hover:{bg:e?"hover:bg-gray-700":"hover:bg-gray-100",text:e?"hover:text-white":"hover:text-gray-900",border:e?"hover:border-gray-500":"hover:border-gray-400",subtle:e?"hover:bg-gray-600":"hover:bg-gray-200",card:e?"hover:bg-gray-700":"hover:bg-gray-50"},focus:{ring:"focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}})}}]);
//# sourceMappingURL=127.228d4f59.chunk.js.map