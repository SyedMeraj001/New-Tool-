{"version":3,"file":"static/js/169.1a778f65.chunk.js","mappings":"2HACO,MAAMA,EAIX,gBAAOC,CAAUC,EAAQC,GAAuC,IAAjCC,EAAIC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,SAAUG,EAAQH,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,CAAC,EAC1D,MAAMI,EAAa,CACjBC,GAAIC,KAAKC,kBACTC,WAAW,IAAIC,MAAOC,cACtBb,SACAE,OACAD,KAAMQ,KAAKK,aAAab,GACxBK,WACAS,UAAWN,KAAKO,eAChBC,UAAWR,KAAKS,cAChBC,UAAWC,UAAUD,WAavB,OAVAV,KAAKY,SAASC,QAAQf,GAGlBE,KAAKY,SAASjB,OAASK,KAAKc,aAC9Bd,KAAKY,SAAWZ,KAAKY,SAASG,MAAM,EAAGf,KAAKc,aAI9Cd,KAAKgB,kBAEElB,EAAWC,EACpB,CAEA,sBAAOE,GACL,MAAO,SAASE,KAAKc,SAASC,KAAKC,SAASC,SAAS,IAAIC,OAAO,EAAG,IACrE,CAEA,mBAAOd,GACL,IAAID,EAAYgB,eAAeC,QAAQ,kBAKvC,OAJKjB,IACHA,EAAY,WAAWH,KAAKc,SAASC,KAAKC,SAASC,SAAS,IAAIC,OAAO,EAAG,KAC1EC,eAAeE,QAAQ,iBAAkBlB,IAEpCA,CACT,CAEA,kBAAOG,GAEL,MAAO,kBACT,CAEA,mBAAOJ,CAAab,GAElB,IAAKA,EAAM,OAAO,KAElB,MAAMiC,EAAYC,KAAKC,MAAMD,KAAKE,UAAUpC,IAI5CQ,KAAK6B,sBAAsBJ,EADH,CAAC,WAAY,QAAS,SAAU,QAIxD,MAAMK,EAAaJ,KAAKE,UAAUH,GAClC,OAAIK,EAAWnC,OAAS,IACf,CACLoC,YAAY,EACZC,cAAeF,EAAWnC,OAC1BsC,QAASjC,KAAKkC,kBAAkBT,IAI7BA,CACT,CAEA,4BAAOI,CAAsBM,EAAKC,GACb,kBAARD,GAA4B,OAARA,GAE/BE,OAAOC,KAAKH,GAAKI,QAAQC,IACnBJ,EAAgBK,KAAKC,GAASF,EAAIG,cAAcC,SAASF,IAC3DP,EAAIK,GAAO,aACkB,kBAAbL,EAAIK,IACpBxC,KAAK6B,sBAAsBM,EAAIK,GAAMJ,IAG3C,CAEA,wBAAOF,CAAkB1C,GACvB,OAAIqD,MAAMC,QAAQtD,GACT,CACLuD,KAAM,QACNpD,OAAQH,EAAKG,OACbqD,OAAQxD,EAAKuB,MAAM,EAAG,IAEC,kBAATvB,EACT,CACLuD,KAAM,SACNT,KAAMD,OAAOC,KAAK9C,GAClByD,aAAcZ,OAAOa,YACnBb,OAAOc,QAAQ3D,GAAMuB,MAAM,EAAG,KAI7BvB,CACT,CAEA,sBAAOwB,GACL,IACEoC,aAAa5B,QAAQ,gBAAiBE,KAAKE,UAAU5B,KAAKY,UAC5D,CAAE,MAAOyC,GACPC,QAAQC,KAAK,+BAAgCF,EAC/C,CACF,CAEA,mBAAOG,GACL,IACE,MAAMC,EAASL,aAAa7B,QAAQ,iBAChCkC,IACFzD,KAAKY,SAAWc,KAAKC,MAAM8B,GAE/B,CAAE,MAAOJ,GACPC,QAAQC,KAAK,4BAA6BF,GAC1CrD,KAAKY,SAAW,EAClB,CACF,CAEA,kBAAO8C,GAA2B,IAAfC,EAAOjE,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,CAAC,EACxBkE,EAAW,IAAI5D,KAAKY,UA+BxB,OA5BI+C,EAAQlE,OACVmE,EAAWA,EAASC,OAAOC,GACzBA,EAAMrE,KAAKkD,cAAcC,SAASe,EAAQlE,KAAKkD,iBAI/CgB,EAAQpE,SACVqE,EAAWA,EAASC,OAAOC,GACzBA,EAAMvE,OAAOoD,cAAcC,SAASe,EAAQpE,OAAOoD,iBAInDgB,EAAQI,YACVH,EAAWA,EAASC,OAAOC,GACzB,IAAI3D,KAAK2D,EAAM5D,YAAc,IAAIC,KAAKwD,EAAQI,aAI9CJ,EAAQK,UACVJ,EAAWA,EAASC,OAAOC,GACzB,IAAI3D,KAAK2D,EAAM5D,YAAc,IAAIC,KAAKwD,EAAQK,WAI9CL,EAAQrD,YACVsD,EAAWA,EAASC,OAAOC,GAASA,EAAMxD,YAAcqD,EAAQrD,YAG3DsD,CACT,CAEA,qBAAOK,CAAezE,EAAMC,GAC1B,OAAOO,KAAKV,UAAU,aAAcE,EAAMC,EAAM,CAC9CyE,SAAU,WACVC,YAAatB,MAAMC,QAAQtD,GAAQA,EAAKG,OAAS,EACjDyE,WAAYpE,KAAKqE,kBAAkB7E,IAEvC,CAEA,sBAAO8E,CAAgBC,EAASC,EAAS/E,GACvC,MAAMgF,EAAUzE,KAAK0E,cAAcH,EAASC,GAC5C,OAAOxE,KAAKV,UAAU,cAAe,CAAEmF,UAASD,WAAW/E,EAAM,CAC/DyE,SAAU,WACVS,YAAaF,EAAQ9E,OACrBiF,cAAeH,EAAQI,IAAIC,GAAKA,EAAEpC,QAEtC,CAEA,wBAAOqC,CAAkBvF,EAAMC,GAC7B,OAAOO,KAAKV,UAAU,cAAeE,EAAMC,EAAM,CAC/CyE,SAAU,WACVC,YAAatB,MAAMC,QAAQtD,GAAQA,EAAKG,OAAS,GAErD,CAEA,oBAAOqF,CAAcxF,EAAMyF,EAAUC,GACnC,OAAOlF,KAAKV,UAAU,kBAAmB,CAAEE,OAAM0F,YAAYD,EAAU,CACrEf,SAAU,WACVgB,WACAf,YAAatB,MAAMC,QAAQtD,GAAQA,EAAKG,OAAS,GAErD,CAEA,iBAAOwF,CAAW1F,GAChB,OAAOO,KAAKV,UAAU,aAAc,KAAMG,EAAM,CAC9CyE,SAAU,kBAEd,CAEA,kBAAOkB,CAAY3F,GACjB,OAAOO,KAAKV,UAAU,cAAe,KAAMG,EAAM,CAC/CyE,SAAU,kBAEd,CAEA,4BAAOmB,CAAsBC,EAAY7F,EAAM8F,GAC7C,OAAOvF,KAAKV,UAAU,mBAAoBiG,EAAY9F,EAAM,CAC1DyE,SAAU,YACVoB,cAEJ,CAEA,oBAAOZ,CAAcH,EAASC,GAC5B,MAAMC,EAAU,GAEhB,IAAKF,IAAYC,EAAS,OAAOC,EAEjC,MAAMe,EAAiB,SAACC,EAAKC,GAAwB,IAAfC,EAAIjG,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,GAC3C2C,OAAOC,KAAKoD,GAASnD,QAAQC,IAC3B,MAAMoD,EAAcD,EAAO,GAAGA,KAAQnD,IAAQA,EAE1CiD,EAAIjD,KAASkD,EAAQlD,KACK,kBAAjBkD,EAAQlD,IAAsC,OAAjBkD,EAAQlD,IACxB,kBAAbiD,EAAIjD,IAAkC,OAAbiD,EAAIjD,GACtCgD,EAAeC,EAAIjD,GAAMkD,EAAQlD,GAAMoD,GAEvCnB,EAAQoB,KAAK,CACXnD,MAAOkD,EACPE,SAAUL,EAAIjD,GACduD,SAAUL,EAAQlD,GAClBwD,gBAAyBpG,IAAb6F,EAAIjD,GAAqB,QAAU,gBAOvDH,OAAOC,KAAKmD,GAAKlD,QAAQC,IACvB,KAAMA,KAAOkD,GAAU,CACrB,MAAME,EAAcD,EAAO,GAAGA,KAAQnD,IAAQA,EAC9CiC,EAAQoB,KAAK,CACXnD,MAAOkD,EACPE,SAAUL,EAAIjD,GACduD,cAAUnG,EACVoG,WAAY,WAEhB,GAEJ,EAGA,OADAR,EAAejB,EAASC,GACjBC,CACT,CAEA,wBAAOJ,CAAkB7E,GACvB,OAAKA,EAEDqD,MAAMC,QAAQtD,GACT,IAAI,IAAIyG,IAAIzG,EAAKqF,IAAIqB,GAAQA,EAAKhC,UAAUL,OAAOsC,WACjD3G,EAAK0E,SACP,CAAC1E,EAAK0E,UAEN7B,OAAOC,KAAK9C,GAAMqE,OAAOrB,GAC9B,CAAC,gBAAiB,SAAU,cAAcI,SAASJ,IARrC,EAWpB,CAEA,0BAAO4D,GAAmC,IAAfzC,EAAOjE,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,CAAC,EACpC,MAAMyD,EAAUnD,KAAK0D,YAAYC,GAgBjC,MAde,CACb0C,aAAa,IAAIlG,MAAOC,cACxBkG,aAAcnD,EAAQxD,OACtB4G,UAAW,CACTC,MAAOrD,EAAQxD,OAAS,EAAIwD,EAAQA,EAAQxD,OAAS,GAAGO,UAAY,KACpEuG,IAAKtD,EAAQxD,OAAS,EAAIwD,EAAQ,GAAGjD,UAAY,MAEnD+B,QAASjC,KAAK0G,qBAAqBvD,GACnCA,QAASA,EAAQ0B,IAAIf,IAAK,IAAA6C,EAAA,MAAK,IAC1B7C,EACHtE,KAAgB,QAAVmH,EAAA7C,EAAMtE,YAAI,IAAAmH,GAAVA,EAAY5E,WAAa,cAAgB+B,EAAMtE,QAK3D,CAEA,2BAAOkH,CAAqBvD,GAC1B,MAAMlB,EAAU,CACd2E,aAAc,CAAC,EACfC,WAAY,CAAC,EACbC,eAAgB,CAAC,EACjBC,cAAe,CAAC,GAqBlB,OAlBA5D,EAAQZ,QAAQuB,IAAU,IAADkD,EAEvB/E,EAAQ2E,aAAa9C,EAAMvE,SAAW0C,EAAQ2E,aAAa9C,EAAMvE,SAAW,GAAK,EAGjF0C,EAAQ4E,WAAW/C,EAAMrE,OAASwC,EAAQ4E,WAAW/C,EAAMrE,OAAS,GAAK,EAGvD,QAAlBuH,EAAIlD,EAAMjE,gBAAQ,IAAAmH,GAAdA,EAAgB9C,WAClBjC,EAAQ6E,eAAehD,EAAMjE,SAASqE,WACnCjC,EAAQ6E,eAAehD,EAAMjE,SAASqE,WAAa,GAAK,GAI7D,MAAM+C,EAAOnD,EAAM5D,UAAUgH,MAAM,KAAK,GACxCjF,EAAQ8E,cAAcE,IAAShF,EAAQ8E,cAAcE,IAAS,GAAK,IAG9DhF,CACT,CAEA,qBAAOkF,GAA+C,IAAhCC,EAAM1H,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,OAAQiE,EAAOjE,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,CAAC,EAChD,MAAM2H,EAASrH,KAAKoG,oBAAoBzC,GAExC,MAAe,QAAXyD,EACKpH,KAAKsH,aAAaD,EAAOlE,SAG3BzB,KAAKE,UAAUyF,EAAQ,KAAM,EACtC,CAEA,mBAAOC,CAAanE,GAClB,GAAuB,IAAnBA,EAAQxD,OAAc,MAAO,GAWjC,MAAO,CATS,CAAC,YAAa,SAAU,OAAQ,aAAc,eACjDwD,EAAQ0B,IAAIf,GAAS,CAChCA,EAAM5D,UACN4D,EAAMvE,OACNuE,EAAMrE,KACNqE,EAAMxD,UACNoB,KAAKE,UAAUkC,EAAMjE,UAAY,CAAC,MAGVgF,IAAI0C,GAC5BA,EAAI1C,IAAInC,GAAS,IAAI8E,OAAO9E,GAAO+E,QAAQ,KAAM,UAAUC,KAAK,MAChEA,KAAK,KACT,CAEA,oBAAOC,GACL3H,KAAKY,SAAW,GAChBwC,aAAawE,WAAW,gBAC1B,CAEA,oBAAOC,GACL,MAAO,CACLvB,aAActG,KAAKY,SAASjB,OAC5BmI,YAAa9H,KAAKY,SAASjB,OAAS,EAAIK,KAAKY,SAASZ,KAAKY,SAASjB,OAAS,GAAGO,UAAY,KAC5F6H,YAAa/H,KAAKY,SAASjB,OAAS,EAAIK,KAAKY,SAAS,GAAGV,UAAY,KACrE8H,YAAa,IAAI,IAAI/B,IAAIjG,KAAKY,SAASiE,IAAIf,GAASA,EAAMrE,QAAQE,OAClEsI,eAAgB,IAAI,IAAIhC,IAAIjG,KAAKY,SAASiE,IAAIf,GAASA,EAAMxD,aAAaX,OAE9E,EAjWWN,EACJuB,SAAW,GADPvB,EAEJyB,WAAa,IAmWtBzB,EAAWmE,eAEX,S,kCC9PA,QAxGA,MACE,oBAAa0E,CAAQC,GAAyB,IAAfC,EAAO1I,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,CAAC,EACxC,IACE,MAAM2I,QAAiBC,MAAM,4BAAcH,IAAY,CACrDI,QAAS,CAAE,eAAgB,sBAAuBH,EAAQG,YACvDH,IAEL,OAAOC,EAASG,SAAWH,EAASI,OAAS,CAAEpF,MAAO,YACxD,CAAE,MAAOA,GAEP,OADAC,QAAQC,KAAK,mBAAoBF,EAAMqF,SAChC,CAAErF,MAAO,kBAClB,CACF,CAGA,mBAAOsF,CAAaC,GAClB,OAAO5I,KAAKkI,QAAQ,8BAA+B,CACjDW,OAAQ,OACRC,KAAMpH,KAAKE,UAAUgH,IAEzB,CAEA,cAAOG,GACL,OAAO/I,KAAKkI,QAAQ,yBAA0B,CAAEW,OAAQ,QAC1D,CAGA,kBAAOG,CAAYJ,GACjB,OAAO5I,KAAKkI,QAAQ,6BAA8B,CAChDW,OAAQ,OACRC,KAAMpH,KAAKE,UAAUgH,IAEzB,CAEA,aAAOK,GACL,OAAOjJ,KAAKkI,QAAQ,wBAAyB,CAAEW,OAAQ,QACzD,CAGA,2BAAOK,GACL,OAAOlJ,KAAKkI,QAAQ,uBACtB,CAGA,wBAAaiB,CAAY3J,GACvB,IACE,MAAM6I,QAAiBrI,KAAKkI,QAAQ,YAAa,CAC/CW,OAAQ,OACRC,KAAMpH,KAAKE,UAAUpC,KAGvB,GAAI6I,EAAShF,MACX,MAAM,IAAI+F,MAAMf,EAAShF,OAG3B,OAAOgF,CACT,CAAE,MAAOhF,GAEP,OADAC,QAAQD,MAAM,2BAA4BA,IACnC,CACT,CACF,CAGA,yBAAOgG,CAAmB7J,GACxB,OAAOQ,KAAKkI,QAAQ,uBAAwB,CAC1CW,OAAQ,OACRC,KAAMpH,KAAKE,UAAUpC,IAEzB,CAGA,mBAAO8J,CAAa9J,GAClB,OAAOQ,KAAKkI,QAAQ,iBAAkB,CACpCW,OAAQ,OACRC,KAAMpH,KAAKE,UAAUpC,IAEzB,CAGA,kBAAO2J,CAAY3J,GACjB,OAAOQ,KAAKkI,QAAQ,YAAa,CAC/BW,OAAQ,OACRC,KAAMpH,KAAKE,UAAUpC,IAEzB,CAEA,iBAAO+J,CAAWC,GAChB,OAAOxJ,KAAKkI,QAAQ,aAAasB,IACnC,CAEA,mBAAOC,CAAaD,GAClB,OAAOxJ,KAAKkI,QAAQ,eAAesB,IACrC,CAEA,iBAAOE,CAAWF,GAChB,OAAOxJ,KAAKkI,QAAQ,aAAasB,IACnC,CAGA,uBAAOG,CAAiBH,GACtB,OAAOxJ,KAAKkI,QAAQ,kBAAkBsB,IACxC,E,kCCtGK,MAAMI,EAyBX,sBAAOC,CAAgBrK,GACrB,MAAMsK,EAAU,CACdC,SAAS,EACTC,OAAQ,GACRC,SAAU,GACVC,YAAa,GACbC,MAAO,KAGT,OAAK3K,GAAwB,kBAATA,GAQpB,CAAC,gBAAiB,SAAU,cAAc+C,QAAQ2B,IAChD,GAAI1E,EAAK0E,GAAW,CAClB,MAAMkG,EAAkBpK,KAAKqK,iBAAiBnG,EAAU1E,EAAK0E,IAC7D4F,EAAQE,OAAOnE,QAAQuE,EAAgBJ,QACvCF,EAAQG,SAASpE,QAAQuE,EAAgBH,UACzCH,EAAQI,YAAYrE,QAAQuE,EAAgBF,aAExCE,EAAgBJ,OAAOrK,OAAS,IAClCmK,EAAQC,SAAU,EAEtB,IAIFD,EAAQK,MAAQnK,KAAKsK,yBAAyBR,GAG9C9J,KAAKuK,uBAAuB/K,EAAMsK,GAE3BA,IA1BLA,EAAQC,SAAU,EAClBD,EAAQE,OAAOnE,KAAK,gCACpBiE,EAAQK,MAAQ,EACTL,EAwBX,CAEA,uBAAOO,CAAiBnG,EAAUsG,GAChC,MAAMV,EAAU,CAAEE,OAAQ,GAAIC,SAAU,GAAIC,YAAa,IACnDO,EAAQzK,KAAK0K,gBAAgBxG,IAAa,CAAC,EA0CjD,OAxCA7B,OAAOc,QAAQqH,GAAcjI,QAAQoI,IAAsB,IAApBC,EAAQC,GAAMF,EACnD,GAAe,gBAAXC,EAA0B,OAE9B,MAAME,EAAOL,EAAMG,GACnB,IAAKE,EAEH,YADAhB,EAAQG,SAASpE,KAAK,mBAAmB+E,SAAc1G,cAKzD,GAAI4G,EAAKC,WAAuB,OAAVF,QAA4BjL,IAAViL,GAAiC,KAAVA,GAE7D,YADAf,EAAQE,OAAOnE,KAAK,GAAG+E,oBAAyB1G,cAKlD,IAAK4G,EAAKC,WAAuB,OAAVF,QAA4BjL,IAAViL,GAAiC,KAAVA,GAC9D,OAIF,MAAMG,EAAWC,WAAWJ,GACxBK,MAAMF,GACRlB,EAAQE,OAAOnE,KAAK,GAAG+E,6BAKrBI,EAAWF,EAAKK,KAClBrB,EAAQE,OAAOnE,KAAK,GAAG+E,yBAA8BE,EAAKK,OAAOL,EAAKM,QAGpEJ,EAAWF,EAAKO,KAClBvB,EAAQE,OAAOnE,KAAK,GAAG+E,mBAAwBE,EAAKO,OAAOP,EAAKM,QAIlEpL,KAAKsL,+BAA+BpH,EAAU0G,EAAQI,EAAUlB,MAG3DA,CACT,CAEA,qCAAOwB,CAA+BpH,EAAU0G,EAAQC,EAAOf,GAE5C,kBAAb5F,IACa,yBAAX0G,GAAqCC,EAAQ,IAC/Cf,EAAQG,SAASpE,KAAK,mEAGT,oBAAX+E,GAA0C,IAAVC,GAClCf,EAAQG,SAASpE,KAAK,6DAKT,WAAb3B,IACa,8BAAX0G,IAA2CC,EAAQ,IAAMA,EAAQ,KACnEf,EAAQG,SAASpE,KAAK,2EAGT,qBAAX+E,GAAiCC,EAAQ,IAC3Cf,EAAQG,SAASpE,KAAK,oEAKT,eAAb3B,IACa,yBAAX0G,GAAqCC,EAAQ,IAC/Cf,EAAQG,SAASpE,KAAK,sEAGT,iBAAX+E,GAA6BC,EAAQ,GACvCf,EAAQG,SAASpE,KAAK,iEAG5B,CAEA,6BAAO0E,CAAuB/K,EAAMsK,GAElC,MAAMyB,EAAM/L,EAAKgM,eAAiB,CAAC,EAC7BC,EAASjM,EAAKiM,QAAU,CAAC,EACzBC,EAAMlM,EAAKmM,YAAc,CAAC,EAGhC,GAAIJ,EAAIK,mBAAqBL,EAAIM,gBAAiB,CAC1BN,EAAIM,gBAAkBN,EAAIK,kBAC5B,GAClB9B,EAAQG,SAASpE,KAAK,4DAE1B,CAUA,GAPI4F,EAAOK,gBAAkBJ,EAAIK,WAC3BN,EAAOK,eAAiB,IAAMJ,EAAIK,UAAY,IAChDjC,EAAQG,SAASpE,KAAK,6CAKtB4F,EAAOO,qBAAuBxM,EAAKyM,aAAc,CAC1BR,EAAOO,oBAAsBxM,EAAKyM,aAAgB,IACrD,IACpBnC,EAAQG,SAASpE,KAAK,mDAE1B,CACF,CAEA,+BAAOyE,CAAyBR,GAC9B,IAAIK,EAAQ,IAMZ,OAHAA,GAAiC,GAAxBL,EAAQE,OAAOrK,OACxBwK,GAAmC,EAA1BL,EAAQG,SAAStK,OAEnBuB,KAAKmK,IAAI,EAAGlB,EACrB,CAEA,+BAAO+B,CAAyB1M,GAC9B,MAAM2M,EAAe,CACnBX,cAAe,EACfC,OAAQ,EACRE,WAAY,EACZS,QAAS,GAkBX,MAfA,CAAC,gBAAiB,SAAU,cAAc7J,QAAQ2B,IAChD,MAAMsG,EAAehL,EAAK0E,IAAa,CAAC,EAClCuG,EAAQzK,KAAK0K,gBAAgBxG,IAAa,CAAC,EAC3CmI,EAAchK,OAAOC,KAAKmI,GAAO9K,OACjC2M,EAAejK,OAAOC,KAAKkI,GAAc3G,OAAOrB,GAC5C,gBAARA,GAA+C,OAAtBgI,EAAahI,SAAuC5C,IAAtB4K,EAAahI,IAA4C,KAAtBgI,EAAahI,IACvG7C,OAEFwM,EAAajI,GAAYmI,EAAc,EAAInL,KAAKqL,MAAOD,EAAeD,EAAe,KAAO,IAG9FF,EAAaC,QAAUlL,KAAKqL,OACzBJ,EAAaX,cAAgBW,EAAaV,OAASU,EAAaR,YAAc,GAG1EQ,CACT,CAEA,+BAAOK,CAAyBhN,GAC9B,MAAMiN,EAAazM,KAAK6J,gBAAgBrK,GAClC2M,EAAenM,KAAKkM,yBAAyB1M,GAEnD,MAAO,CACLU,WAAW,IAAIC,MAAOC,cACtBsM,gBAAiBD,EAAWtC,MAC5BwC,kBAAmBR,EAAaC,QAChCQ,OAAQH,EAAW1C,QAAU,SAAW,SACxC9H,QAAS,CACP4K,YAAaJ,EAAWzC,OAAOrK,OAC/BmN,cAAeL,EAAWxC,SAAStK,OACnCoN,iBAAkBN,EAAWvC,YAAYvK,QAE3CqN,QAAS,CACPhD,OAAQyC,EAAWzC,OACnBC,SAAUwC,EAAWxC,SACrBC,YAAauC,EAAWvC,YACxBiC,gBAEFc,gBAAiBjN,KAAKkN,wBAAwBT,EAAYN,GAE9D,CAEA,8BAAOe,CAAwBT,EAAYN,GACzC,MAAMc,EAAkB,GA6BxB,OA1BId,EAAaC,QAAU,IACzBa,EAAgBpH,KAAK,CACnB9C,KAAM,eACNoK,SAAU,OACVzE,QAAS,8FAKT+D,EAAWzC,OAAOrK,OAAS,GAC7BsN,EAAgBpH,KAAK,CACnB9C,KAAM,aACNoK,SAAU,WACVzE,QAAS,mFAKT+D,EAAWxC,SAAStK,OAAS,GAC/BsN,EAAgBpH,KAAK,CACnB9C,KAAM,UACNoK,SAAU,SACVzE,QAAS,8EAINuE,CACT,CAEA,oCAAOG,CAA8BlJ,GACnC,OAAOlE,KAAK0K,gBAAgBxG,IAAa,CAAC,CAC5C,CAEA,oBAAOmJ,CAAcnJ,EAAU0G,GAC7B,SAAU5K,KAAK0K,gBAAgBxG,KAAalE,KAAK0K,gBAAgBxG,GAAU0G,GAC7E,EAnRWhB,EACJc,gBAAkB,CACvBc,cAAe,CACbI,kBAAmB,CAAET,IAAK,EAAGE,IAAK,IAASD,KAAM,MAAOL,UAAU,GAClEc,gBAAiB,CAAEV,IAAK,EAAGE,IAAK,IAAQD,KAAM,SAAUL,UAAU,GAClEuC,WAAY,CAAEnC,IAAK,EAAGE,IAAK,IAASD,KAAM,QAAML,UAAU,GAC1DwC,eAAgB,CAAEpC,IAAK,EAAGE,IAAK,IAAOD,KAAM,OAAQL,UAAU,GAC9DyC,qBAAsB,CAAErC,IAAK,EAAGE,IAAK,IAAKD,KAAM,IAAKL,UAAU,IAEjEU,OAAQ,CACNK,eAAgB,CAAEX,IAAK,EAAGE,IAAK,IAASD,KAAM,QAASL,UAAU,GACjE0C,0BAA2B,CAAEtC,IAAK,EAAGE,IAAK,IAAKD,KAAM,IAAKL,UAAU,GACpE2C,cAAe,CAAEvC,IAAK,EAAGE,IAAK,IAAMD,KAAM,QAASL,UAAU,GAC7DiB,oBAAqB,CAAEb,IAAK,EAAGE,IAAK,IAAUD,KAAM,MAAOL,UAAU,GACrE4C,iBAAkB,CAAExC,IAAK,EAAGE,IAAK,IAAKD,KAAM,IAAKL,UAAU,IAE7DY,WAAY,CACVI,UAAW,CAAEZ,IAAK,EAAGE,IAAK,GAAID,KAAM,QAASL,UAAU,GACvD6C,qBAAsB,CAAEzC,IAAK,EAAGE,IAAK,IAAKD,KAAM,IAAKL,UAAU,GAC/D8C,eAAgB,CAAE1C,IAAK,EAAGE,IAAK,IAAKD,KAAM,IAAKL,UAAU,GACzD+C,aAAc,CAAE3C,IAAK,EAAGE,IAAK,IAAMD,KAAM,QAASL,UAAU,GAC5DgD,gBAAiB,CAAE5C,IAAK,EAAGE,IAAK,IAAWD,KAAM,MAAOL,UAAU,KAiQxE,S,6EC5DA,MAEA,EAFc,IA1Nd,MACEiD,WAAAA,GACEhO,KAAKR,KAAOQ,KAAKiO,iBACnB,CAEAA,eAAAA,GACE,MAAMxK,EAASL,aAAa7B,QAAQ,gBACpC,OAAIkC,EACK/B,KAAKC,MAAM8B,GAIb,CACLN,QAAS,GACT+K,WAAY,GACZC,KAAM,CACJC,aAAc,EACdC,eAAgB,EAChB7C,cAAe,EACfC,OAAQ,EACRE,WAAY,EACZrF,aAAc,EACdgI,aAAa,IAAInO,MAAOC,eAE1BmO,OAAQ,GAEZ,CAEAC,aAAAA,GACEpL,aAAa5B,QAAQ,eAAgBE,KAAKE,UAAU5B,KAAKR,MAC3D,CAGAiP,QAAAA,CAAS3K,GACP,MAAM4K,EAAW,IACZ5K,EACH/D,GAAII,KAAKc,MACTf,WAAW,IAAIC,MAAOC,cACtBwM,OAAQ,UAKV,OAHA5M,KAAKR,KAAK2D,QAAQ0C,KAAK6I,GACvB1O,KAAK2O,aACL3O,KAAKwO,gBACEE,CACT,CAEAE,UAAAA,GAA0B,IAAfjL,EAAOjE,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,CAAC,EAChByD,EAAUnD,KAAKR,KAAK2D,QAAQU,OAAOC,GAA0B,WAAjBA,EAAM8I,QAYtD,OAVIjJ,EAAQO,WACVf,EAAUA,EAAQU,OAAOC,GAASA,EAAMI,WAAaP,EAAQO,WAE3DP,EAAQkL,WACV1L,EAAUA,EAAQU,OAAOC,GAAS,IAAI3D,KAAK2D,EAAM5D,YAAc,IAAIC,KAAKwD,EAAQkL,YAE9ElL,EAAQmL,SACV3L,EAAUA,EAAQU,OAAOC,GAAS,IAAI3D,KAAK2D,EAAM5D,YAAc,IAAIC,KAAKwD,EAAQmL,UAG3E3L,CACT,CAGA4L,gBAAAA,CAAiBC,GACf,MAAMC,EAAS,IACVD,EACHjP,GAAII,KAAKc,MACTiO,YAAY,IAAI/O,MAAOC,cACvBwM,OAAQoC,EAAIpC,QAAU,kBAIxB,OAFA5M,KAAKR,KAAK0O,WAAWrI,KAAKoJ,GAC1BjP,KAAKwO,gBACES,CACT,CAEAE,iBAAAA,GAAiC,IAAfxL,EAAOjE,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,CAAC,EACvB0P,EAAOpP,KAAKR,KAAK0O,WASrB,OAPIvK,EAAQO,WACVkL,EAAOA,EAAKvL,OAAOmL,GAAOA,EAAI9K,UAAY8K,EAAI9K,SAASvB,gBAAkBgB,EAAQO,SAASvB,gBAExFgB,EAAQiJ,SACVwC,EAAOA,EAAKvL,OAAOmL,GAAOA,EAAIpC,SAAWjJ,EAAQiJ,SAG5CwC,CACT,CAGAT,UAAAA,GACE,MAAMxL,EAAUnD,KAAK4O,aACfV,EAAalO,KAAKR,KAAK0O,WAGvBmB,EAAalM,EAAQU,OAAOyL,GAAoB,kBAAfA,EAAEpL,UACnCqL,EAAapM,EAAQU,OAAOyL,GAAoB,WAAfA,EAAEpL,UACnCsL,EAAarM,EAAQU,OAAOyL,GAAoB,eAAfA,EAAEpL,UAEnCuL,EAAWzP,KAAK0P,uBAAuBL,GACvCM,EAAW3P,KAAK0P,uBAAuBH,GACvCK,EAAW5P,KAAK0P,uBAAuBF,GAGvCpB,EAAelN,KAAKqL,MAAkB,GAAXkD,EAA4B,GAAXE,EAA4B,GAAXC,GAG7DC,EAAe3B,EAAWrK,OAAOmL,GAAsB,aAAfA,EAAIpC,QAAuBjN,OACnE0O,EAAiBH,EAAWvO,OAAS,EAAIuB,KAAKqL,MAAOsD,EAAe3B,EAAWvO,OAAU,KAAO,EAEtGK,KAAKR,KAAK2O,KAAO,CACfC,eACAC,iBACA7C,cAAeiE,EACfhE,OAAQkE,EACRhE,WAAYiE,EACZtJ,aAAcnD,EAAQxD,OACtB2O,aAAa,IAAInO,MAAOC,eAI1BJ,KAAKR,KAAK+O,OAAO1I,KAAK,CACpB3F,WAAW,IAAIC,MAAOC,cACtBgO,eACA5C,cAAeiE,EACfhE,OAAQkE,EACRhE,WAAYiE,IAIV5P,KAAKR,KAAK+O,OAAO5O,OAAS,KAC5BK,KAAKR,KAAK+O,OAASvO,KAAKR,KAAK+O,OAAOxN,OAAO,KAG7Cf,KAAKwO,eACP,CAEAkB,sBAAAA,CAAuBvM,GACrB,GAAuB,IAAnBA,EAAQxD,OAAc,OAAO,EAEjC,IAAImQ,EAAa,EAQjB,OAPA3M,EAAQZ,QAAQuB,IAEd,MAAMiM,EAAcjM,EAAMkM,OAAS,EAAKlM,EAAM+G,MAAQ/G,EAAMkM,OAAU,IAAM,GACtE7F,EAAQjJ,KAAKiK,IAAIjK,KAAKmK,IAAI0E,EAAa,GAAI,KACjDD,GAAc3F,IAGTjJ,KAAKqL,MAAMuD,EAAa3M,EAAQxD,OACzC,CAEAsQ,OAAAA,GACE,OAAOjQ,KAAKR,KAAK2O,IACnB,CAEA+B,SAAAA,GAAsB,IAAZC,EAAIzQ,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,GACf,MAAM0Q,EAAS,IAAIjQ,KAGnB,OAFAiQ,EAAOC,QAAQD,EAAOE,UAAYH,GAE3BnQ,KAAKR,KAAK+O,OAAO1K,OAAO0M,GAC7B,IAAIpQ,KAAKoQ,EAAMrQ,YAAckQ,EAEjC,CAGAI,uBAAAA,GACE,MAAMrN,EAAUnD,KAAK4O,aAMrB,MALqB,CACnBpD,cAAerI,EAAQU,OAAOyL,GAAoB,kBAAfA,EAAEpL,UAA8BvE,OACnE8L,OAAQtI,EAAQU,OAAOyL,GAAoB,WAAfA,EAAEpL,UAAuBvE,OACrDgM,WAAYxI,EAAQU,OAAOyL,GAAoB,eAAfA,EAAEpL,UAA2BvE,OAGjE,CAEA8Q,mBAAAA,GACE,MAAMtN,EAAUnD,KAAK4O,aAMrB,MALqB,CACnB8B,KAAMvN,EAAQU,OAAOyL,GAAqB,SAAhBA,EAAEqB,WAAsBhR,OAClDiR,OAAQzN,EAAQU,OAAOyL,GAAqB,WAAhBA,EAAEqB,WAAwBhR,OACtDkR,IAAK1N,EAAQU,OAAOyL,GAAqB,QAAhBA,EAAEqB,WAAqBhR,OAGpD,CAEAmR,gBAAAA,GACE,MAAM3N,EAAUnD,KAAK4O,aACfmC,EAAc,CAAC,EAUrB,OARA5N,EAAQZ,QAAQuB,IACd,MAAMkN,EAAQ,IAAI7Q,KAAK2D,EAAM5D,WAAW+Q,mBAAmB,QAAS,CAClED,MAAO,QACPE,KAAM,YAERH,EAAYC,IAAUD,EAAYC,IAAU,GAAK,IAG5CD,CACT,CAGAI,aAAAA,CAAcC,GACZ,MAAMjO,EAAUnD,KAAK4O,aACfT,EAAOnO,KAAKiQ,UACZ/B,EAAalO,KAAKmP,oBAExB,MAAO,CACLiC,WACA/K,aAAa,IAAIlG,MAAOC,cACxB+N,OACAhL,QAASA,EAAQpC,MAAM,EAAG,IAC1BmN,WAAYA,EAAWnN,MAAM,EAAG,GAChCsQ,qBAAsBrR,KAAKwQ,0BAC3BjC,OAAQvO,KAAKkQ,UAAU,GAE3B,GC1MWoB,EAAWC,UACtB,MAAMC,EAAcpO,aAAa7B,QAAQ,gBAAkB,cAGrDkQ,EAAgB,IACjB3N,EACH/D,GAAI+D,EAAM/D,IAAMI,KAAKc,MAAMG,WAC3BsQ,UAAWF,EACXG,WAAW,IAAIxR,MAAOC,cACtBwR,SAAU9N,EAAM8N,SAAW,GAAK,GAIlC,GAAI9N,EAAMI,UAAYJ,EAAM8G,OAC1B,IACE,MAAM6B,EAAa7C,EAAAA,EAAeC,gBAAgB,CAAE,CAAC/F,EAAMI,UAAW,CAAE,CAACJ,EAAM8G,QAAS9G,EAAM+G,SAE9F,IAAK4B,IAAeA,EAAW1C,QAAS,CACtC,MAAM8H,EAAQpF,GAAcA,EAAWzC,OAAUyC,EAAWzC,OAAOtC,KAAK,MAAQ,2BAChF,MAAM,IAAI0B,MAAM,sBAAsByI,IACxC,CAEAJ,EAAcK,aAAerF,EAAWqF,aACxCL,EAAcM,iBAAmBtF,EAAWsF,iBAC5CN,EAAcO,WAAa,CAAC3S,EAAAA,EAAW4E,eAAeH,EAAO0N,GAC/D,CAAE,MAAOS,GAEP,MAAMA,CACR,MAGAR,EAAcO,WAAa,CAAC3S,EAAAA,EAAW4E,eAAeH,EAAO0N,IAI/D,MAAMU,EAAc,CAClBC,YAAarO,EAAMqO,aAAeV,EAAcU,aAAe,UAC/DC,OAAQtO,EAAMsO,QAAU,GACxBC,OAAQvO,EAAMuO,QAAU,GACxBC,cAAexO,EAAMwO,gBAAiB,IAAInS,MAAOoS,cACjD/G,cAAe1H,EAAM0H,gBAAqC,kBAAnB1H,EAAMI,SAA+B,CAAE,CAACJ,EAAM8G,QAAS9G,EAAM+G,OAAU,CAAC,GAC/GY,OAAQ3H,EAAM2H,SAA8B,WAAnB3H,EAAMI,SAAwB,CAAE,CAACJ,EAAM8G,QAAS9G,EAAM+G,OAAU,CAAC,GAC1Fc,WAAY7H,EAAM6H,aAAkC,eAAnB7H,EAAMI,SAA4B,CAAE,CAACJ,EAAM8G,QAAS9G,EAAM+G,OAAU,CAAC,GACtGrB,OAAQgI,EACRtR,WAAW,IAAIC,MAAOC,eAIxB,IACE,MAAMiI,QAAiBmK,EAAAA,EAAWrJ,YAAY+I,GAE9C,GAAI7J,IAAaA,EAAShF,MAAO,CAE/B,IACMoP,GAAmC,oBAAnBA,EAAMhE,UAAyBgE,EAAMhE,SAASgD,EACpE,CAAE,MAAOnC,GACPhM,QAAQC,KAAK,yBAA0B+L,EACzC,CAGA,IACE,MAAMoD,EAAWhR,KAAKC,MAAMyB,aAAa7B,QAAQ,YAAc,MAC/DmR,EAAS7M,KAAK4L,GACdrO,aAAa5B,QAAQ,UAAWE,KAAKE,UAAU8Q,GACjD,CAAE,MAAOpD,GACPhM,QAAQC,KAAK,2CAA4C+L,EAC3D,CAEA,MAAO,CAAEqD,SAAS,EAAMC,OAAQ,UAAWpT,KAAMiS,EACnD,CAEA,MAAM,IAAIrI,OAAc,OAARf,QAAQ,IAARA,OAAQ,EAARA,EAAUhF,QAAS,sBACrC,CAAE,MAAOA,GACPC,QAAQC,KAAK,qDAAsDF,GAGnE,IACE,MAAMqP,EAAWhR,KAAKC,MAAMyB,aAAa7B,QAAQ,YAAc,MAC/DmR,EAAS7M,KAAK4L,GACdrO,aAAa5B,QAAQ,UAAWE,KAAKE,UAAU8Q,IAC/CpP,QAAQuP,IAAI,wCAAyCH,EAAS/S,OAChE,CAAE,MAAOsS,GACP3O,QAAQC,KAAK,oCAAqC0O,EACpD,CAGA,IACMQ,GAAmC,oBAAnBA,EAAMhE,UAAyBgE,EAAMhE,SAASgD,EACpE,CAAE,MAAOnC,GACPhM,QAAQC,KAAK,yBAA0B+L,EACzC,CAGA,MAAO,CAAEqD,SAAS,EAAMC,OAAQ,eAAgBpT,KAAMiS,EACxD,GAsCWqB,EAAgBvB,UAC3B,MAAMC,EAAcpO,aAAa7B,QAAQ,gBAAkB,cAG3D,IACE,MAAMwR,EAAQ3P,aAAa7B,QAAQ,WACnC,GAAIwR,EAAO,CACT,MAAMC,EAAStR,KAAKC,MAAMoR,GAC1B,GAAIlQ,MAAMC,QAAQkQ,IAAWA,EAAOrT,OAAS,EAE3C,OADA2D,QAAQuP,IAAI,8BAA+BG,EAAOrT,OAAQ,WACnDqT,CAEX,CACF,CAAE,MAAOf,GACP3O,QAAQC,KAAK,2CAA4C0O,EAC3D,CAGA,IACE,MAAMgB,QAAeT,EAAAA,EAAWjJ,WAAWiI,GAC3C,GAAIyB,IAAWA,EAAO5P,MAAO,CAC3B,GAAIR,MAAMC,QAAQmQ,IAAWA,EAAOtT,OAAS,EAAG,OAAOsT,EACvD,GAAIA,EAAOzT,MAAQqD,MAAMC,QAAQmQ,EAAOzT,OAASyT,EAAOzT,KAAKG,OAAS,EAAG,OAAOsT,EAAOzT,IACzF,CACF,CAAE,MAAO6D,GACPC,QAAQC,KAAK,qCACf,CAIA,OADAD,QAAQuP,IAAI,gDACL,IA2La,qBAAXK,QAA2B9P,aAAa7B,QAAQ,kBArLpDkR,GAAqC,oBAArBA,EAAM9D,WAM3B8D,EAAM9D,aALJrL,QAAQC,KAAK,6D","sources":["utils/AuditTrail.js","services/apiService.js","utils/dataValidation.js","api/database.js","utils/storage.js"],"sourcesContent":["// ESG Data Audit Trail and Change Tracking System\nexport class AuditTrail {\n  static auditLog = [];\n  static maxLogSize = 1000;\n\n  static logChange(action, data, user = 'system', metadata = {}) {\n    const auditEntry = {\n      id: this.generateAuditId(),\n      timestamp: new Date().toISOString(),\n      action,\n      user,\n      data: this.sanitizeData(data),\n      metadata,\n      sessionId: this.getSessionId(),\n      ipAddress: this.getClientIP(),\n      userAgent: navigator.userAgent\n    };\n\n    this.auditLog.unshift(auditEntry);\n    \n    // Maintain log size limit\n    if (this.auditLog.length > this.maxLogSize) {\n      this.auditLog = this.auditLog.slice(0, this.maxLogSize);\n    }\n\n    // Persist to localStorage\n    this.persistAuditLog();\n    \n    return auditEntry.id;\n  }\n\n  static generateAuditId() {\n    return `audit_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n  }\n\n  static getSessionId() {\n    let sessionId = sessionStorage.getItem('esg_session_id');\n    if (!sessionId) {\n      sessionId = `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n      sessionStorage.setItem('esg_session_id', sessionId);\n    }\n    return sessionId;\n  }\n\n  static getClientIP() {\n    // In a real application, this would be handled by the backend\n    return 'client_ip_masked';\n  }\n\n  static sanitizeData(data) {\n    // Remove sensitive information and limit data size\n    if (!data) return null;\n    \n    const sanitized = JSON.parse(JSON.stringify(data));\n    \n    // Remove sensitive fields\n    const sensitiveFields = ['password', 'token', 'secret', 'key'];\n    this.removeSensitiveFields(sanitized, sensitiveFields);\n    \n    // Limit data size\n    const dataString = JSON.stringify(sanitized);\n    if (dataString.length > 5000) {\n      return { \n        _truncated: true, \n        _originalSize: dataString.length,\n        summary: this.createDataSummary(sanitized)\n      };\n    }\n    \n    return sanitized;\n  }\n\n  static removeSensitiveFields(obj, sensitiveFields) {\n    if (typeof obj !== 'object' || obj === null) return;\n    \n    Object.keys(obj).forEach(key => {\n      if (sensitiveFields.some(field => key.toLowerCase().includes(field))) {\n        obj[key] = '[REDACTED]';\n      } else if (typeof obj[key] === 'object') {\n        this.removeSensitiveFields(obj[key], sensitiveFields);\n      }\n    });\n  }\n\n  static createDataSummary(data) {\n    if (Array.isArray(data)) {\n      return {\n        type: 'array',\n        length: data.length,\n        sample: data.slice(0, 2)\n      };\n    } else if (typeof data === 'object') {\n      return {\n        type: 'object',\n        keys: Object.keys(data),\n        sampleValues: Object.fromEntries(\n          Object.entries(data).slice(0, 3)\n        )\n      };\n    }\n    return data;\n  }\n\n  static persistAuditLog() {\n    try {\n      localStorage.setItem('esg_audit_log', JSON.stringify(this.auditLog));\n    } catch (error) {\n      console.warn('Failed to persist audit log:', error);\n    }\n  }\n\n  static loadAuditLog() {\n    try {\n      const stored = localStorage.getItem('esg_audit_log');\n      if (stored) {\n        this.auditLog = JSON.parse(stored);\n      }\n    } catch (error) {\n      console.warn('Failed to load audit log:', error);\n      this.auditLog = [];\n    }\n  }\n\n  static getAuditLog(filters = {}) {\n    let filtered = [...this.auditLog];\n\n    // Apply filters\n    if (filters.user) {\n      filtered = filtered.filter(entry => \n        entry.user.toLowerCase().includes(filters.user.toLowerCase())\n      );\n    }\n\n    if (filters.action) {\n      filtered = filtered.filter(entry => \n        entry.action.toLowerCase().includes(filters.action.toLowerCase())\n      );\n    }\n\n    if (filters.startDate) {\n      filtered = filtered.filter(entry => \n        new Date(entry.timestamp) >= new Date(filters.startDate)\n      );\n    }\n\n    if (filters.endDate) {\n      filtered = filtered.filter(entry => \n        new Date(entry.timestamp) <= new Date(filters.endDate)\n      );\n    }\n\n    if (filters.sessionId) {\n      filtered = filtered.filter(entry => entry.sessionId === filters.sessionId);\n    }\n\n    return filtered;\n  }\n\n  static trackDataEntry(data, user) {\n    return this.logChange('DATA_ENTRY', data, user, {\n      category: 'esg_data',\n      recordCount: Array.isArray(data) ? data.length : 1,\n      categories: this.extractCategories(data)\n    });\n  }\n\n  static trackDataUpdate(oldData, newData, user) {\n    const changes = this.detectChanges(oldData, newData);\n    return this.logChange('DATA_UPDATE', { changes, newData }, user, {\n      category: 'esg_data',\n      changeCount: changes.length,\n      fieldsChanged: changes.map(c => c.field)\n    });\n  }\n\n  static trackDataDeletion(data, user) {\n    return this.logChange('DATA_DELETE', data, user, {\n      category: 'esg_data',\n      recordCount: Array.isArray(data) ? data.length : 1\n    });\n  }\n\n  static trackApproval(data, approver, decision) {\n    return this.logChange('APPROVAL_ACTION', { data, decision }, approver, {\n      category: 'workflow',\n      decision,\n      recordCount: Array.isArray(data) ? data.length : 1\n    });\n  }\n\n  static trackLogin(user) {\n    return this.logChange('USER_LOGIN', null, user, {\n      category: 'authentication'\n    });\n  }\n\n  static trackLogout(user) {\n    return this.logChange('USER_LOGOUT', null, user, {\n      category: 'authentication'\n    });\n  }\n\n  static trackReportGeneration(reportType, user, parameters) {\n    return this.logChange('REPORT_GENERATED', parameters, user, {\n      category: 'reporting',\n      reportType\n    });\n  }\n\n  static detectChanges(oldData, newData) {\n    const changes = [];\n    \n    if (!oldData || !newData) return changes;\n\n    const compareObjects = (old, current, path = '') => {\n      Object.keys(current).forEach(key => {\n        const currentPath = path ? `${path}.${key}` : key;\n        \n        if (old[key] !== current[key]) {\n          if (typeof current[key] === 'object' && current[key] !== null && \n              typeof old[key] === 'object' && old[key] !== null) {\n            compareObjects(old[key], current[key], currentPath);\n          } else {\n            changes.push({\n              field: currentPath,\n              oldValue: old[key],\n              newValue: current[key],\n              changeType: old[key] === undefined ? 'added' : 'modified'\n            });\n          }\n        }\n      });\n\n      // Check for deleted fields\n      Object.keys(old).forEach(key => {\n        if (!(key in current)) {\n          const currentPath = path ? `${path}.${key}` : key;\n          changes.push({\n            field: currentPath,\n            oldValue: old[key],\n            newValue: undefined,\n            changeType: 'deleted'\n          });\n        }\n      });\n    };\n\n    compareObjects(oldData, newData);\n    return changes;\n  }\n\n  static extractCategories(data) {\n    if (!data) return [];\n    \n    if (Array.isArray(data)) {\n      return [...new Set(data.map(item => item.category).filter(Boolean))];\n    } else if (data.category) {\n      return [data.category];\n    } else {\n      return Object.keys(data).filter(key => \n        ['environmental', 'social', 'governance'].includes(key)\n      );\n    }\n  }\n\n  static generateAuditReport(filters = {}) {\n    const entries = this.getAuditLog(filters);\n    \n    const report = {\n      generatedAt: new Date().toISOString(),\n      totalEntries: entries.length,\n      dateRange: {\n        start: entries.length > 0 ? entries[entries.length - 1].timestamp : null,\n        end: entries.length > 0 ? entries[0].timestamp : null\n      },\n      summary: this.generateAuditSummary(entries),\n      entries: entries.map(entry => ({\n        ...entry,\n        data: entry.data?._truncated ? '[TRUNCATED]' : entry.data\n      }))\n    };\n\n    return report;\n  }\n\n  static generateAuditSummary(entries) {\n    const summary = {\n      actionCounts: {},\n      userCounts: {},\n      categoryCounts: {},\n      dailyActivity: {}\n    };\n\n    entries.forEach(entry => {\n      // Action counts\n      summary.actionCounts[entry.action] = (summary.actionCounts[entry.action] || 0) + 1;\n      \n      // User counts\n      summary.userCounts[entry.user] = (summary.userCounts[entry.user] || 0) + 1;\n      \n      // Category counts\n      if (entry.metadata?.category) {\n        summary.categoryCounts[entry.metadata.category] = \n          (summary.categoryCounts[entry.metadata.category] || 0) + 1;\n      }\n      \n      // Daily activity\n      const date = entry.timestamp.split('T')[0];\n      summary.dailyActivity[date] = (summary.dailyActivity[date] || 0) + 1;\n    });\n\n    return summary;\n  }\n\n  static exportAuditLog(format = 'json', filters = {}) {\n    const report = this.generateAuditReport(filters);\n    \n    if (format === 'csv') {\n      return this.convertToCSV(report.entries);\n    }\n    \n    return JSON.stringify(report, null, 2);\n  }\n\n  static convertToCSV(entries) {\n    if (entries.length === 0) return '';\n    \n    const headers = ['Timestamp', 'Action', 'User', 'Session ID', 'Metadata'];\n    const rows = entries.map(entry => [\n      entry.timestamp,\n      entry.action,\n      entry.user,\n      entry.sessionId,\n      JSON.stringify(entry.metadata || {})\n    ]);\n    \n    return [headers, ...rows].map(row => \n      row.map(field => `\"${String(field).replace(/\"/g, '\"\"')}\"`).join(',')\n    ).join('\\n');\n  }\n\n  static clearAuditLog() {\n    this.auditLog = [];\n    localStorage.removeItem('esg_audit_log');\n  }\n\n  static getAuditStats() {\n    return {\n      totalEntries: this.auditLog.length,\n      oldestEntry: this.auditLog.length > 0 ? this.auditLog[this.auditLog.length - 1].timestamp : null,\n      newestEntry: this.auditLog.length > 0 ? this.auditLog[0].timestamp : null,\n      uniqueUsers: [...new Set(this.auditLog.map(entry => entry.user))].length,\n      uniqueSessions: [...new Set(this.auditLog.map(entry => entry.sessionId))].length\n    };\n  }\n}\n\n// Initialize audit log on module load\nAuditTrail.loadAuditLog();\n\nexport default AuditTrail;","const API_BASE = 'http://localhost:3004/api';\r\n\r\nclass APIService {\r\n  static async request(endpoint, options = {}) {\r\n    try {\r\n      const response = await fetch(`${API_BASE}${endpoint}`, {\r\n        headers: { 'Content-Type': 'application/json', ...options.headers },\r\n        ...options\r\n      });\r\n      return response.ok ? await response.json() : { error: 'API Error' };\r\n    } catch (error) {\r\n      console.warn('API unavailable:', error.message);\r\n      return { error: 'Backend offline' };\r\n    }\r\n  }\r\n\r\n  // ERP Integration\r\n  static configureERP(config) {\r\n    return this.request('/integrations/erp/configure', {\r\n      method: 'POST',\r\n      body: JSON.stringify(config)\r\n    });\r\n  }\r\n\r\n  static syncERP() {\r\n    return this.request('/integrations/erp/sync', { method: 'POST' });\r\n  }\r\n\r\n  // HR Integration  \r\n  static configureHR(config) {\r\n    return this.request('/integrations/hr/configure', {\r\n      method: 'POST',\r\n      body: JSON.stringify(config)\r\n    });\r\n  }\r\n\r\n  static syncHR() {\r\n    return this.request('/integrations/hr/sync', { method: 'POST' });\r\n  }\r\n\r\n  // Integration Status\r\n  static getIntegrationStatus() {\r\n    return this.request('/integrations/status');\r\n  }\r\n\r\n  // ESG Data Management\r\n  static async saveESGData(data) {\r\n    try {\r\n      const response = await this.request('/esg/data', {\r\n        method: 'POST',\r\n        body: JSON.stringify(data)\r\n      });\r\n      \r\n      if (response.error) {\r\n        throw new Error(response.error);\r\n      }\r\n      \r\n      return response;\r\n    } catch (error) {\r\n      console.error('Failed to save ESG data:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  // Compliance Validation\r\n  static validateCompliance(data) {\r\n    return this.request('/compliance/validate', {\r\n      method: 'POST',\r\n      body: JSON.stringify(data)\r\n    });\r\n  }\r\n\r\n  // GHG Calculations\r\n  static calculateGHG(data) {\r\n    return this.request('/ghg/calculate', {\r\n      method: 'POST',\r\n      body: JSON.stringify(data)\r\n    });\r\n  }\r\n\r\n  // ESG Data Management\r\n  static saveESGData(data) {\r\n    return this.request('/esg/data', {\r\n      method: 'POST',\r\n      body: JSON.stringify(data)\r\n    });\r\n  }\r\n\r\n  static getESGData(userId) {\r\n    return this.request(`/esg/data/${userId}`);\r\n  }\r\n\r\n  static getESGScores(userId) {\r\n    return this.request(`/esg/scores/${userId}`);\r\n  }\r\n\r\n  static getESGKPIs(userId) {\r\n    return this.request(`/esg/kpis/${userId}`);\r\n  }\r\n\r\n  // Analytics Data\r\n  static getAnalyticsData(userId) {\r\n    return this.request(`/esg/analytics/${userId}`);\r\n  }\r\n}\r\n\r\nexport default APIService;","// ESG Data Validation Engine\nexport class DataValidation {\n  static validationRules = {\n    environmental: {\n      energyConsumption: { min: 0, max: 1000000, unit: 'kWh', required: true },\n      carbonEmissions: { min: 0, max: 100000, unit: 'T CO2e', required: true },\n      waterUsage: { min: 0, max: 1000000, unit: 'mÂ³', required: false },\n      wasteGenerated: { min: 0, max: 10000, unit: 'tons', required: false },\n      renewableEnergyRatio: { min: 0, max: 100, unit: '%', required: false }\n    },\n    social: {\n      totalEmployees: { min: 1, max: 1000000, unit: 'count', required: true },\n      femaleEmployeesPercentage: { min: 0, max: 100, unit: '%', required: false },\n      trainingHours: { min: 0, max: 1000, unit: 'hours', required: false },\n      communityInvestment: { min: 0, max: 10000000, unit: 'USD', required: false },\n      employeeTurnover: { min: 0, max: 100, unit: '%', required: false }\n    },\n    governance: {\n      boardSize: { min: 3, max: 20, unit: 'count', required: true },\n      independentDirectors: { min: 0, max: 100, unit: '%', required: true },\n      ethicsTraining: { min: 0, max: 100, unit: '%', required: false },\n      dataBreaches: { min: 0, max: 1000, unit: 'count', required: false },\n      regulatoryFines: { min: 0, max: 100000000, unit: 'USD', required: false }\n    }\n  };\n\n  static validateESGData(data) {\n    const results = {\n      isValid: true,\n      errors: [],\n      warnings: [],\n      suggestions: [],\n      score: 100\n    };\n\n    if (!data || typeof data !== 'object') {\n      results.isValid = false;\n      results.errors.push('Invalid data format provided');\n      results.score = 0;\n      return results;\n    }\n\n    // Validate each category\n    ['environmental', 'social', 'governance'].forEach(category => {\n      if (data[category]) {\n        const categoryResults = this.validateCategory(category, data[category]);\n        results.errors.push(...categoryResults.errors);\n        results.warnings.push(...categoryResults.warnings);\n        results.suggestions.push(...categoryResults.suggestions);\n        \n        if (categoryResults.errors.length > 0) {\n          results.isValid = false;\n        }\n      }\n    });\n\n    // Calculate validation score\n    results.score = this.calculateValidationScore(results);\n    \n    // Add cross-category validations\n    this.performCrossValidation(data, results);\n    \n    return results;\n  }\n\n  static validateCategory(category, categoryData) {\n    const results = { errors: [], warnings: [], suggestions: [] };\n    const rules = this.validationRules[category] || {};\n\n    Object.entries(categoryData).forEach(([metric, value]) => {\n      if (metric === 'description') return; // Skip description fields\n      \n      const rule = rules[metric];\n      if (!rule) {\n        results.warnings.push(`Unknown metric '${metric}' in ${category} category`);\n        return;\n      }\n\n      // Required field validation\n      if (rule.required && (value === null || value === undefined || value === '')) {\n        results.errors.push(`${metric} is required in ${category} category`);\n        return;\n      }\n\n      // Skip validation for empty optional fields\n      if (!rule.required && (value === null || value === undefined || value === '')) {\n        return;\n      }\n\n      // Numeric validation\n      const numValue = parseFloat(value);\n      if (isNaN(numValue)) {\n        results.errors.push(`${metric} must be a valid number`);\n        return;\n      }\n\n      // Range validation\n      if (numValue < rule.min) {\n        results.errors.push(`${metric} cannot be less than ${rule.min} ${rule.unit}`);\n      }\n      \n      if (numValue > rule.max) {\n        results.errors.push(`${metric} cannot exceed ${rule.max} ${rule.unit}`);\n      }\n\n      // Business logic validations\n      this.performBusinessLogicValidation(category, metric, numValue, results);\n    });\n\n    return results;\n  }\n\n  static performBusinessLogicValidation(category, metric, value, results) {\n    // Environmental validations\n    if (category === 'environmental') {\n      if (metric === 'renewableEnergyRatio' && value > 95) {\n        results.warnings.push('Renewable energy ratio above 95% is exceptional - please verify');\n      }\n      \n      if (metric === 'carbonEmissions' && value === 0) {\n        results.warnings.push('Zero carbon emissions reported - please confirm accuracy');\n      }\n    }\n\n    // Social validations\n    if (category === 'social') {\n      if (metric === 'femaleEmployeesPercentage' && (value < 10 || value > 90)) {\n        results.warnings.push('Gender distribution appears imbalanced - consider diversity initiatives');\n      }\n      \n      if (metric === 'employeeTurnover' && value > 30) {\n        results.warnings.push('High employee turnover detected - may indicate retention issues');\n      }\n    }\n\n    // Governance validations\n    if (category === 'governance') {\n      if (metric === 'independentDirectors' && value < 30) {\n        results.warnings.push('Low board independence - consider increasing independent directors');\n      }\n      \n      if (metric === 'dataBreaches' && value > 0) {\n        results.warnings.push('Data breaches reported - ensure proper cybersecurity measures');\n      }\n    }\n  }\n\n  static performCrossValidation(data, results) {\n    // Cross-category consistency checks\n    const env = data.environmental || {};\n    const social = data.social || {};\n    const gov = data.governance || {};\n\n    // Energy vs Emissions consistency\n    if (env.energyConsumption && env.carbonEmissions) {\n      const emissionRatio = env.carbonEmissions / env.energyConsumption;\n      if (emissionRatio > 1) {\n        results.warnings.push('Carbon emissions seem high relative to energy consumption');\n      }\n    }\n\n    // Company size consistency\n    if (social.totalEmployees && gov.boardSize) {\n      if (social.totalEmployees < 50 && gov.boardSize > 10) {\n        results.warnings.push('Board size appears large for company size');\n      }\n    }\n\n    // Investment vs Revenue consistency\n    if (social.communityInvestment && data.totalRevenue) {\n      const investmentRatio = (social.communityInvestment / data.totalRevenue) * 100;\n      if (investmentRatio > 10) {\n        results.warnings.push('Community investment ratio is exceptionally high');\n      }\n    }\n  }\n\n  static calculateValidationScore(results) {\n    let score = 100;\n    \n    // Deduct points for errors and warnings\n    score -= results.errors.length * 20;\n    score -= results.warnings.length * 5;\n    \n    return Math.max(0, score);\n  }\n\n  static validateDataCompleteness(data) {\n    const completeness = {\n      environmental: 0,\n      social: 0,\n      governance: 0,\n      overall: 0\n    };\n\n    ['environmental', 'social', 'governance'].forEach(category => {\n      const categoryData = data[category] || {};\n      const rules = this.validationRules[category] || {};\n      const totalFields = Object.keys(rules).length;\n      const filledFields = Object.keys(categoryData).filter(key => \n        key !== 'description' && categoryData[key] !== null && categoryData[key] !== undefined && categoryData[key] !== ''\n      ).length;\n      \n      completeness[category] = totalFields > 0 ? Math.round((filledFields / totalFields) * 100) : 0;\n    });\n\n    completeness.overall = Math.round(\n      (completeness.environmental + completeness.social + completeness.governance) / 3\n    );\n\n    return completeness;\n  }\n\n  static generateValidationReport(data) {\n    const validation = this.validateESGData(data);\n    const completeness = this.validateDataCompleteness(data);\n    \n    return {\n      timestamp: new Date().toISOString(),\n      validationScore: validation.score,\n      completenessScore: completeness.overall,\n      status: validation.isValid ? 'passed' : 'failed',\n      summary: {\n        totalErrors: validation.errors.length,\n        totalWarnings: validation.warnings.length,\n        totalSuggestions: validation.suggestions.length\n      },\n      details: {\n        errors: validation.errors,\n        warnings: validation.warnings,\n        suggestions: validation.suggestions,\n        completeness\n      },\n      recommendations: this.generateRecommendations(validation, completeness)\n    };\n  }\n\n  static generateRecommendations(validation, completeness) {\n    const recommendations = [];\n\n    // Completeness recommendations\n    if (completeness.overall < 70) {\n      recommendations.push({\n        type: 'completeness',\n        priority: 'high',\n        message: 'Data completeness is below 70%. Consider filling missing fields for better ESG reporting.'\n      });\n    }\n\n    // Error recommendations\n    if (validation.errors.length > 0) {\n      recommendations.push({\n        type: 'validation',\n        priority: 'critical',\n        message: 'Critical validation errors found. Please address all errors before submission.'\n      });\n    }\n\n    // Warning recommendations\n    if (validation.warnings.length > 3) {\n      recommendations.push({\n        type: 'quality',\n        priority: 'medium',\n        message: 'Multiple data quality warnings detected. Review and verify data accuracy.'\n      });\n    }\n\n    return recommendations;\n  }\n\n  static getValidationRulesForCategory(category) {\n    return this.validationRules[category] || {};\n  }\n\n  static isValidMetric(category, metric) {\n    return !!(this.validationRules[category] && this.validationRules[category][metric]);\n  }\n}\n\nexport default DataValidation;","// Simple in-memory database with localStorage persistence\r\nclass ESGDatabase {\r\n  constructor() {\r\n    this.data = this.loadFromStorage();\r\n  }\r\n\r\n  loadFromStorage() {\r\n    const stored = localStorage.getItem('esg_database');\r\n    if (stored) {\r\n      return JSON.parse(stored);\r\n    }\r\n    \r\n    // Initialize with empty data\r\n    return {\r\n      entries: [],\r\n      compliance: [],\r\n      kpis: {\r\n        overallScore: 0,\r\n        complianceRate: 0,\r\n        environmental: 0,\r\n        social: 0,\r\n        governance: 0,\r\n        totalEntries: 0,\r\n        lastUpdated: new Date().toISOString()\r\n      },\r\n      trends: []\r\n    };\r\n  }\r\n\r\n  saveToStorage() {\r\n    localStorage.setItem('esg_database', JSON.stringify(this.data));\r\n  }\r\n\r\n  // ESG Entries\r\n  addEntry(entry) {\r\n    const newEntry = {\r\n      ...entry,\r\n      id: Date.now(),\r\n      timestamp: new Date().toISOString(),\r\n      status: 'active'\r\n    };\r\n    this.data.entries.push(newEntry);\r\n    this.updateKPIs();\r\n    this.saveToStorage();\r\n    return newEntry;\r\n  }\r\n\r\n  getEntries(filters = {}) {\r\n    let entries = this.data.entries.filter(entry => entry.status === 'active');\r\n    \r\n    if (filters.category) {\r\n      entries = entries.filter(entry => entry.category === filters.category);\r\n    }\r\n    if (filters.dateFrom) {\r\n      entries = entries.filter(entry => new Date(entry.timestamp) >= new Date(filters.dateFrom));\r\n    }\r\n    if (filters.dateTo) {\r\n      entries = entries.filter(entry => new Date(entry.timestamp) <= new Date(filters.dateTo));\r\n    }\r\n    \r\n    return entries;\r\n  }\r\n\r\n  // Compliance Documents\r\n  addComplianceDoc(doc) {\r\n    const newDoc = {\r\n      ...doc,\r\n      id: Date.now(),\r\n      uploadedAt: new Date().toISOString(),\r\n      status: doc.status || 'Pending Review'\r\n    };\r\n    this.data.compliance.push(newDoc);\r\n    this.saveToStorage();\r\n    return newDoc;\r\n  }\r\n\r\n  getComplianceDocs(filters = {}) {\r\n    let docs = this.data.compliance;\r\n    \r\n    if (filters.category) {\r\n      docs = docs.filter(doc => doc.category && doc.category.toLowerCase() === filters.category.toLowerCase());\r\n    }\r\n    if (filters.status) {\r\n      docs = docs.filter(doc => doc.status === filters.status);\r\n    }\r\n    \r\n    return docs;\r\n  }\r\n\r\n  // KPI Calculations\r\n  updateKPIs() {\r\n    const entries = this.getEntries();\r\n    const compliance = this.data.compliance;\r\n    \r\n    // Calculate category scores\r\n    const envEntries = entries.filter(e => e.category === 'environmental');\r\n    const socEntries = entries.filter(e => e.category === 'social');\r\n    const govEntries = entries.filter(e => e.category === 'governance');\r\n    \r\n    const envScore = this.calculateCategoryScore(envEntries);\r\n    const socScore = this.calculateCategoryScore(socEntries);\r\n    const govScore = this.calculateCategoryScore(govEntries);\r\n    \r\n    // Overall score (weighted average)\r\n    const overallScore = Math.round((envScore * 0.4 + socScore * 0.3 + govScore * 0.3));\r\n    \r\n    // Compliance rate\r\n    const approvedDocs = compliance.filter(doc => doc.status === 'Approved').length;\r\n    const complianceRate = compliance.length > 0 ? Math.round((approvedDocs / compliance.length) * 100) : 0;\r\n    \r\n    this.data.kpis = {\r\n      overallScore,\r\n      complianceRate,\r\n      environmental: envScore,\r\n      social: socScore,\r\n      governance: govScore,\r\n      totalEntries: entries.length,\r\n      lastUpdated: new Date().toISOString()\r\n    };\r\n    \r\n    // Add to trends\r\n    this.data.trends.push({\r\n      timestamp: new Date().toISOString(),\r\n      overallScore,\r\n      environmental: envScore,\r\n      social: socScore,\r\n      governance: govScore\r\n    });\r\n    \r\n    // Keep only last 30 trend points\r\n    if (this.data.trends.length > 30) {\r\n      this.data.trends = this.data.trends.slice(-30);\r\n    }\r\n    \r\n    this.saveToStorage();\r\n  }\r\n\r\n  calculateCategoryScore(entries) {\r\n    if (entries.length === 0) return 0;\r\n    \r\n    let totalScore = 0;\r\n    entries.forEach(entry => {\r\n      // Calculate score based on target achievement\r\n      const achievement = entry.target > 0 ? (entry.value / entry.target) * 100 : 50;\r\n      const score = Math.min(Math.max(achievement, 0), 100);\r\n      totalScore += score;\r\n    });\r\n    \r\n    return Math.round(totalScore / entries.length);\r\n  }\r\n\r\n  getKPIs() {\r\n    return this.data.kpis;\r\n  }\r\n\r\n  getTrends(days = 30) {\r\n    const cutoff = new Date();\r\n    cutoff.setDate(cutoff.getDate() - days);\r\n    \r\n    return this.data.trends.filter(trend => \r\n      new Date(trend.timestamp) >= cutoff\r\n    );\r\n  }\r\n\r\n  // Analytics data\r\n  getCategoryDistribution() {\r\n    const entries = this.getEntries();\r\n    const distribution = {\r\n      environmental: entries.filter(e => e.category === 'environmental').length,\r\n      social: entries.filter(e => e.category === 'social').length,\r\n      governance: entries.filter(e => e.category === 'governance').length\r\n    };\r\n    return distribution;\r\n  }\r\n\r\n  getRiskDistribution() {\r\n    const entries = this.getEntries();\r\n    const distribution = {\r\n      high: entries.filter(e => e.riskLevel === 'high').length,\r\n      medium: entries.filter(e => e.riskLevel === 'medium').length,\r\n      low: entries.filter(e => e.riskLevel === 'low').length\r\n    };\r\n    return distribution;\r\n  }\r\n\r\n  getMonthlyTrends() {\r\n    const entries = this.getEntries();\r\n    const monthlyData = {};\r\n    \r\n    entries.forEach(entry => {\r\n      const month = new Date(entry.timestamp).toLocaleDateString('en-US', { \r\n        month: 'short', \r\n        year: 'numeric' \r\n      });\r\n      monthlyData[month] = (monthlyData[month] || 0) + 1;\r\n    });\r\n    \r\n    return monthlyData;\r\n  }\r\n\r\n  // Reports data\r\n  getReportData(template) {\r\n    const entries = this.getEntries();\r\n    const kpis = this.getKPIs();\r\n    const compliance = this.getComplianceDocs();\r\n    \r\n    return {\r\n      template,\r\n      generatedAt: new Date().toISOString(),\r\n      kpis,\r\n      entries: entries.slice(0, 10), // Latest 10 entries\r\n      compliance: compliance.slice(0, 5), // Latest 5 compliance docs\r\n      categoryDistribution: this.getCategoryDistribution(),\r\n      trends: this.getTrends(7) // Last 7 days\r\n    };\r\n  }\r\n}\r\n\r\n// Create singleton instance\r\nconst esgDB = new ESGDatabase();\r\n\r\nexport default esgDB;","// ESG Data Storage with Backend Integration\r\nimport APIService from '../services/apiService.js';\r\nimport DataValidation from './dataValidation.js';\r\nimport AuditTrail from './AuditTrail.js';\r\nimport { ESGAnalytics } from './esgAnalytics.js';\r\nimport { ReportGenerator } from './reportGenerator.js';\r\nimport { DataGovernance } from './dataGovernance.js';\r\nimport { AuditSupport } from './auditSupport.js';\r\nimport { MaterialityAssessment } from './materialityAssessment.js';\r\nimport { SupplyChain } from './supplyChain.js';\r\nimport esgDB from '../api/database.js';\r\n\r\n// Save a single ESG data entry with comprehensive validation\r\nexport const saveData = async (entry) => {\r\n  const currentUser = localStorage.getItem('currentUser') || 'defaultUser';\r\n\r\n  // Build a base enhanced entry that will be persisted (either to backend or local)\r\n  const enhancedEntry = {\r\n    ...entry,\r\n    id: entry.id || Date.now().toString(),\r\n    createdBy: currentUser,\r\n    createdAt: new Date().toISOString(),\r\n    version: (entry.version || 0) + 1\r\n  };\r\n\r\n  // If entry looks like a single metric (category+metric+value), validate that metric.\r\n  if (entry.category && entry.metric) {\r\n    try {\r\n      const validation = DataValidation.validateESGData({ [entry.category]: { [entry.metric]: entry.value } });\r\n\r\n      if (!validation || !validation.isValid) {\r\n        const msgs = (validation && validation.errors) ? validation.errors.join(', ') : 'Unknown validation error';\r\n        throw new Error(`Validation failed: ${msgs}`);\r\n      }\r\n\r\n      enhancedEntry.qualityScore = validation.qualityScore;\r\n      enhancedEntry.complianceStatus = validation.complianceStatus;\r\n      enhancedEntry.auditTrail = [AuditTrail.trackDataEntry(entry, currentUser)];\r\n    } catch (err) {\r\n      // Bubble up validation errors so callers can show feedback\r\n      throw err;\r\n    }\r\n  } else {\r\n    // Company-level submission (full form): add submission audit\r\n    enhancedEntry.auditTrail = [AuditTrail.trackDataEntry(entry, currentUser)];\r\n  }\r\n\r\n  // Compose payload expected by backend\r\n  const backendData = {\r\n    companyName: entry.companyName || enhancedEntry.companyName || 'Unknown',\r\n    sector: entry.sector || '',\r\n    region: entry.region || '',\r\n    reportingYear: entry.reportingYear || new Date().getFullYear(),\r\n    environmental: entry.environmental || (entry.category === 'environmental' ? { [entry.metric]: entry.value } : {}),\r\n    social: entry.social || (entry.category === 'social' ? { [entry.metric]: entry.value } : {}),\r\n    governance: entry.governance || (entry.category === 'governance' ? { [entry.metric]: entry.value } : {}),\r\n    userId: currentUser,\r\n    timestamp: new Date().toISOString()\r\n  };\r\n\r\n  // Try backend save, fall back to localStorage and in-memory esgDB\r\n  try {\r\n    const response = await APIService.saveESGData(backendData);\r\n\r\n    if (response && !response.error) {\r\n      // Persist to local in-memory DB if available (keeps UI consistent)\r\n      try {\r\n        if (esgDB && typeof esgDB.addEntry === 'function') esgDB.addEntry(enhancedEntry);\r\n      } catch (e) {\r\n        console.warn('esgDB.addEntry failed:', e);\r\n      }\r\n\r\n      // Also keep a copy in localStorage for offline reads\r\n      try {\r\n        const existing = JSON.parse(localStorage.getItem('esgData') || '[]');\r\n        existing.push(enhancedEntry);\r\n        localStorage.setItem('esgData', JSON.stringify(existing));\r\n      } catch (e) {\r\n        console.warn('Failed to write esgData to localStorage:', e);\r\n      }\r\n\r\n      return { success: true, source: 'backend', data: enhancedEntry };\r\n    }\r\n\r\n    throw new Error(response?.error || 'Backend save failed');\r\n  } catch (error) {\r\n    console.warn('Backend save failed, falling back to localStorage:', error);\r\n\r\n    // Save into localStorage array so Reports can pick it up\r\n    try {\r\n      const existing = JSON.parse(localStorage.getItem('esgData') || '[]');\r\n      existing.push(enhancedEntry);\r\n      localStorage.setItem('esgData', JSON.stringify(existing));\r\n      console.log('Saved to localStorage, total entries:', existing.length);\r\n    } catch (err) {\r\n      console.warn('Failed to persist to localStorage', err);\r\n    }\r\n\r\n    // Also attempt to persist in esgDB for immediate UI visibility\r\n    try {\r\n      if (esgDB && typeof esgDB.addEntry === 'function') esgDB.addEntry(enhancedEntry);\r\n    } catch (e) {\r\n      console.warn('esgDB.addEntry failed:', e);\r\n    }\r\n\r\n    // Return a consistent shape so callers can decide what to do\r\n    return { success: true, source: 'localStorage', data: enhancedEntry };\r\n  }\r\n};\r\n\r\n// Save multiple entries with batch validation\r\nexport const saveMultiple = (entries) => {\r\n  const currentUser = localStorage.getItem('currentUser') || 'defaultUser';\r\n  const validatedEntries = [];\r\n  const errors = [];\r\n  \r\n  // Batch validation\r\n  const comprehensiveValidation = entries.map(entry => ({ ...entry, validation: DataValidation.validateESGData(entry) }));\r\n  \r\n  comprehensiveValidation.forEach((validatedEntry, index) => {\r\n    if (validatedEntry.validation.isValid) {\r\n      const enhancedEntry = {\r\n        ...validatedEntry,\r\n        id: validatedEntry.id || `${Date.now()}_${index}`,\r\n        auditTrail: [AuditTrail.trackDataEntry(validatedEntry, currentUser)],\r\n        createdBy: currentUser,\r\n        createdAt: new Date().toISOString(),\r\n        batchId: Date.now().toString()\r\n      };\r\n      \r\n      validatedEntries.push(enhancedEntry);\r\n      esgDB.addEntry(enhancedEntry);\r\n    } else {\r\n      errors.push(`Row ${index + 1}: ${validatedEntry.validation.errors.join(', ')}`);\r\n    }\r\n  });\r\n  \r\n  return {\r\n    success: validatedEntries.length,\r\n    errors: errors.length,\r\n    errorDetails: errors\r\n  };\r\n};\r\n\r\n// Get all stored ESG data\r\nexport const getStoredData = async () => {\r\n  const currentUser = localStorage.getItem('currentUser') || 'defaultUser';\r\n  \r\n  // First, always check localStorage since that's where DataEntry saves data\r\n  try {\r\n    const local = localStorage.getItem('esgData');\r\n    if (local) {\r\n      const parsed = JSON.parse(local);\r\n      if (Array.isArray(parsed) && parsed.length > 0) {\r\n        console.log('Found data in localStorage:', parsed.length, 'entries');\r\n        return parsed;\r\n      }\r\n    }\r\n  } catch (err) {\r\n    console.warn('Failed to read esgData from localStorage', err);\r\n  }\r\n  \r\n  // If no localStorage data, try backend as fallback\r\n  try {\r\n    const result = await APIService.getESGData(currentUser);\r\n    if (result && !result.error) {\r\n      if (Array.isArray(result) && result.length > 0) return result;\r\n      if (result.data && Array.isArray(result.data) && result.data.length > 0) return result.data;\r\n    }\r\n  } catch (error) {\r\n    console.warn('Backend unavailable, no data found');\r\n  }\r\n\r\n  // Return empty array if no data available anywhere\r\n  console.log('No ESG data found in localStorage or backend');\r\n  return [];\r\n};\r\n\r\n// Initialize ESG storage if empty\r\nexport const initializeStorage = () => {\r\n  // Defensive: esgDB may not be ready during circular import or HMR reloads\r\n  if (!esgDB || typeof esgDB.updateKPIs !== 'function') {\r\n    console.warn('esgDB not available yet â skipping initializeStorage');\r\n    return;\r\n  }\r\n\r\n  // Database initializes automatically\r\n  esgDB.updateKPIs();\r\n};\r\n\r\n// Enhanced KPI calculation with analytics\r\nexport const calculateAndSaveKPIs = (filters = {}) => {\r\n  esgDB.updateKPIs();\r\n  const kpis = esgDB.getKPIs();\r\n  const entries = esgDB.getEntries();\r\n  \r\n  // Enhanced analytics\r\n  const environmentalData = entries.filter(e => e.category === 'environmental');\r\n  const socialData = entries.filter(e => e.category === 'social');\r\n  const governanceData = entries.filter(e => e.category === 'governance');\r\n  \r\n  // Calculate trends\r\n  const trends = {\r\n    environmental: ESGAnalytics.calculateTrends(environmentalData),\r\n    social: ESGAnalytics.calculateTrends(socialData),\r\n    governance: ESGAnalytics.calculateTrends(governanceData)\r\n  };\r\n  \r\n  // Data quality assessment\r\n  const qualityScores = entries.map(e => e.qualityScore || 85);\r\n  const avgQualityScore = qualityScores.reduce((a, b) => a + b, 0) / qualityScores.length;\r\n  \r\n  // Compliance rate calculation\r\n  const complianceDocs = esgDB.getComplianceDocs();\r\n  const approvedDocs = complianceDocs.filter(doc => doc.status === 'Approved').length;\r\n  const complianceRate = complianceDocs.length > 0 ? Math.round((approvedDocs / complianceDocs.length) * 100) : 94;\r\n  \r\n  // Audit readiness\r\n  const auditReadyEntries = entries.filter(e => e.auditReadiness !== false).length;\r\n  const auditReadinessRate = entries.length > 0 ? Math.round((auditReadyEntries / entries.length) * 100) : 100;\r\n  \r\n  return {\r\n    ...kpis,\r\n    complianceRate,\r\n    dataQualityScore: Math.round(avgQualityScore),\r\n    auditReadinessRate,\r\n    trends,\r\n    totalDataPoints: entries.length,\r\n    lastUpdated: new Date().toISOString()\r\n  };\r\n};\r\n\r\n// Get KPIs\r\nexport const getKPIs = async () => {\r\n  const currentUser = localStorage.getItem('currentUser') || 'defaultUser';\r\n\r\n  try {\r\n    const result = await APIService.getESGKPIs(currentUser);\r\n    if (result && !result.error) {\r\n      // Prefer array payloads from backend if present\r\n      if (Array.isArray(result) && result.length > 0) return result;\r\n      if (result.data && Array.isArray(result.data) && result.data.length > 0) return result.data;\r\n      return result;\r\n    }\r\n  } catch (error) {\r\n    console.warn('Backend unavailable, using localStorage fallback');\r\n  }\r\n\r\n  // Return default KPIs if backend unavailable\r\n  return {\r\n    overallScore: 0,\r\n    environmental: 0,\r\n    social: 0,\r\n    governance: 0,\r\n    complianceRate: 0,\r\n    totalEntries: 0\r\n  };\r\n};\r\n\r\nconst calculateKPIsFromData = (data) => {\r\n  const environmental = data.filter(d => d.category === 'environmental');\r\n  const social = data.filter(d => d.category === 'social');\r\n  const governance = data.filter(d => d.category === 'governance');\r\n  \r\n  return {\r\n    overallScore: Math.round((environmental.length + social.length + governance.length) / 3),\r\n    environmental: environmental.length,\r\n    social: social.length,\r\n    governance: governance.length,\r\n    complianceRate: 94,\r\n    totalEntries: data.length\r\n  };\r\n};\r\n\r\n// Enhanced analytics data with comprehensive insights\r\nexport const getAnalyticsData = () => {\r\n  const entries = esgDB.getEntries();\r\n  \r\n  // Supply chain analytics\r\n  const suppliers = JSON.parse(localStorage.getItem('suppliers') || '[]');\r\n  const supplyChainRisks = SupplyChain.identifySupplyChainRisks(suppliers);\r\n  \r\n  // Materiality assessment\r\n  const materialityMatrix = MaterialityAssessment.generateMaterialityMatrix(\r\n    entries.map(e => ({\r\n      name: e.metric,\r\n      revenueImpact: Math.random() * 10,\r\n      environmentalImpact: Math.random() * 10,\r\n      socialImpact: Math.random() * 10,\r\n      stakeholderConcern: Math.random() * 10\r\n    }))\r\n  );\r\n  \r\n  return {\r\n    categoryDistribution: esgDB.getCategoryDistribution(),\r\n    riskDistribution: esgDB.getRiskDistribution(),\r\n    monthlyTrends: esgDB.getMonthlyTrends(),\r\n    trends: esgDB.getTrends(),\r\n    supplyChainRisks,\r\n    materialityMatrix,\r\n    dataQualityMetrics: getDataQualityMetrics(),\r\n    frameworkCompliance: getFrameworkCompliance()\r\n  };\r\n};\r\n\r\n// Get compliance data\r\nexport const getComplianceData = () => {\r\n  return esgDB.getComplianceDocs();\r\n};\r\n\r\n// Add compliance document\r\nexport const addComplianceDoc = (doc) => {\r\n  return esgDB.addComplianceDoc(doc);\r\n};\r\n\r\n// Enhanced data quality and compliance functions\r\nexport const getDataQualityMetrics = () => {\r\n  const entries = esgDB.getEntries();\r\n  const qualityChecks = entries.map(entry => \r\n    DataGovernance.validateDataQuality(entry)\r\n  );\r\n  \r\n  return {\r\n    averageScore: qualityChecks.reduce((sum, check) => sum + check.overallScore, 0) / qualityChecks.length,\r\n    completenessRate: qualityChecks.filter(c => c.checks.completeness.status === 'good').length / qualityChecks.length * 100,\r\n    accuracyRate: qualityChecks.filter(c => c.checks.accuracy.status === 'good').length / qualityChecks.length * 100,\r\n    timelinessRate: qualityChecks.filter(c => c.checks.timeliness.status === 'good').length / qualityChecks.length * 100\r\n  };\r\n};\r\n\r\nexport const getFrameworkCompliance = () => {\r\n  const entries = esgDB.getEntries();\r\n  const frameworks = ['GRI', 'SASB', 'TCFD', 'CSRD'];\r\n  \r\n  return frameworks.reduce((compliance, framework) => {\r\n    const frameworkData = entries.filter(e => e.reportingFramework === framework);\r\n    compliance[framework] = DataValidation.validateDataCompleteness(\r\n      { environmental: frameworkData, social: frameworkData, governance: frameworkData }\r\n    );\r\n    return compliance;\r\n  }, {});\r\n};\r\n\r\n// Generate comprehensive ESG report\r\nexport const generateESGReport = (filters = {}) => {\r\n  const entries = esgDB.getEntries();\r\n  const kpis = calculateAndSaveKPIs();\r\n  const analytics = getAnalyticsData();\r\n  \r\n  const reportData = {\r\n    companyName: 'ESG Company',\r\n    environmental: entries.filter(e => e.category === 'environmental'),\r\n    social: entries.filter(e => e.category === 'social'),\r\n    governance: entries.filter(e => e.category === 'governance'),\r\n    kpis,\r\n    analytics\r\n  };\r\n  \r\n  return ReportGenerator.generateESGReport(reportData, filters.framework || 'GRI');\r\n};\r\n\r\n// Initialize database on first load\r\nif (typeof window !== 'undefined' && !localStorage.getItem('esg_database')) {\r\n  initializeStorage();\r\n}\r\n"],"names":["AuditTrail","logChange","action","data","user","arguments","length","undefined","metadata","auditEntry","id","this","generateAuditId","timestamp","Date","toISOString","sanitizeData","sessionId","getSessionId","ipAddress","getClientIP","userAgent","navigator","auditLog","unshift","maxLogSize","slice","persistAuditLog","now","Math","random","toString","substr","sessionStorage","getItem","setItem","sanitized","JSON","parse","stringify","removeSensitiveFields","dataString","_truncated","_originalSize","summary","createDataSummary","obj","sensitiveFields","Object","keys","forEach","key","some","field","toLowerCase","includes","Array","isArray","type","sample","sampleValues","fromEntries","entries","localStorage","error","console","warn","loadAuditLog","stored","getAuditLog","filters","filtered","filter","entry","startDate","endDate","trackDataEntry","category","recordCount","categories","extractCategories","trackDataUpdate","oldData","newData","changes","detectChanges","changeCount","fieldsChanged","map","c","trackDataDeletion","trackApproval","approver","decision","trackLogin","trackLogout","trackReportGeneration","reportType","parameters","compareObjects","old","current","path","currentPath","push","oldValue","newValue","changeType","Set","item","Boolean","generateAuditReport","generatedAt","totalEntries","dateRange","start","end","generateAuditSummary","_entry$data","actionCounts","userCounts","categoryCounts","dailyActivity","_entry$metadata","date","split","exportAuditLog","format","report","convertToCSV","row","String","replace","join","clearAuditLog","removeItem","getAuditStats","oldestEntry","newestEntry","uniqueUsers","uniqueSessions","request","endpoint","options","response","fetch","headers","ok","json","message","configureERP","config","method","body","syncERP","configureHR","syncHR","getIntegrationStatus","saveESGData","Error","validateCompliance","calculateGHG","getESGData","userId","getESGScores","getESGKPIs","getAnalyticsData","DataValidation","validateESGData","results","isValid","errors","warnings","suggestions","score","categoryResults","validateCategory","calculateValidationScore","performCrossValidation","categoryData","rules","validationRules","_ref","metric","value","rule","required","numValue","parseFloat","isNaN","min","unit","max","performBusinessLogicValidation","env","environmental","social","gov","governance","energyConsumption","carbonEmissions","totalEmployees","boardSize","communityInvestment","totalRevenue","validateDataCompleteness","completeness","overall","totalFields","filledFields","round","generateValidationReport","validation","validationScore","completenessScore","status","totalErrors","totalWarnings","totalSuggestions","details","recommendations","generateRecommendations","priority","getValidationRulesForCategory","isValidMetric","waterUsage","wasteGenerated","renewableEnergyRatio","femaleEmployeesPercentage","trainingHours","employeeTurnover","independentDirectors","ethicsTraining","dataBreaches","regulatoryFines","constructor","loadFromStorage","compliance","kpis","overallScore","complianceRate","lastUpdated","trends","saveToStorage","addEntry","newEntry","updateKPIs","getEntries","dateFrom","dateTo","addComplianceDoc","doc","newDoc","uploadedAt","getComplianceDocs","docs","envEntries","e","socEntries","govEntries","envScore","calculateCategoryScore","socScore","govScore","approvedDocs","totalScore","achievement","target","getKPIs","getTrends","days","cutoff","setDate","getDate","trend","getCategoryDistribution","getRiskDistribution","high","riskLevel","medium","low","getMonthlyTrends","monthlyData","month","toLocaleDateString","year","getReportData","template","categoryDistribution","saveData","async","currentUser","enhancedEntry","createdBy","createdAt","version","msgs","qualityScore","complianceStatus","auditTrail","err","backendData","companyName","sector","region","reportingYear","getFullYear","APIService","esgDB","existing","success","source","log","getStoredData","local","parsed","result","window"],"sourceRoot":""}